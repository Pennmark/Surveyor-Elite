$(document).ready(function() {
/*Dynamic OO Javascript - OO PHP - Jquery Quiz Application "SURVEYOR ELITE" by Mark Bazzone SurveyorElite.com 2013 copyright All rights reservered. This site has the right to use this application for personal or professional use, but does not have the right to charge for, or sell any rights or code within or coming from SurveyorElite.com or the Sureyor Elite Application. This site does possess the sole rights to any information collected by or submitted to this site through the Surveyor Elite App. For the protections or use of survey or test informations, see this site's policies regarding information collection.*/
/*-- begin application execution --*/
var launch = new _Launch(); var controller = new _controller(); tempLaunch1 = launch.setOBJS(); var activeAjaxConnections = 0; if(tempLaunch1===true){ var loadPathAdjustment = new _initPath(); tempLaunch2 = controller.launchEdit( tempLaunch1 );}; if(tempLaunch1===true && tempLaunch2===true ){ var loader = new _Loader(); view = new viewer(); render = new _render(); loader.adminPageCheck(); tempLaunch3 = controller.compress(); if(tempLaunch1===true && tempLaunch2===true && tempLaunch3===true ){ controller.uncompress( "defaults" ); var handlers = new _handlers(); render.landing(); }; };
/*-- end application execution --*/
function _initPath(){ this._setPath = function(){ return ("/assets"); }; }; 
function _Launch(){ this.setOBJS = function(){ var newSurvey ; var newSurveyInfo ; var editSurvey ; var editSurveyInfo ; var system_opts ; var localConfig ; var setupBox ; var toolBox ; var htmlBox ; var fixerBox; var connect ; var render ; var view ; var surveyTheme ; var surveySetup ; var surveyFormat ; var user ; var editTestInfo; var ObjTemp ; var tempArray ; var tempLaunch1 = false ; var tempLaunch2 = false ; var tempLaunch3 = false ; var tempLaunch4 = false ; return true; }; this.surveyConfigLocal = function( ){ this.surveySetup = ""; this.surveyTheme = ""; this.surveyCSS = ""; this.surveyType = ""; this.surveyFormat = ""; }; this.surveyConfigThemes = function( ){ this.none = "none"; this._Default = ""; this.Theme_1 = ""; this.Theme_2 = ""; this.Theme_3 = ""; this.Theme_4 = ""; }; this.surveyConfigTests = function( ){ this.allTests = ""; this.testPage = ""; this.testNumber = 0; }; this.surveyConfigUser = function( ){ this.id = ""; this.name = ""; }; this.surveyConfigDefault = function( ){ this.survey_defaults = ""; }; this.setDomain = function( loadPathAdjustment ){ this.domain1 = window.location.host ; this.domain2 = document.domain; this.urlPathname = window.location.href; this.filePathAdj = loadPathAdjustment._setPath(); this.compressed = ""; return this; }; this.themeFill = function( keyNum, key, val ){ if( key == "id" ){ this["id_"+keyNum] = val; }; if( key == "status" ){ this["status_"+keyNum] = val; }; if( key == "default_name" ){ this["default_name_"+keyNum] = val; }; if( key == "default_value" ){ this["default_value_"+keyNum] = val; }; if( key == "default_object" ){ this["default_object_"+keyNum] = val; }; return this; }; this.editTest = function(){ this.order_info = "Renumbering will occur to compensate for shift. Question you are moving will appear BEHIND or Less Than the question you are Moving to. <br>"; this.hint_1 = "<b><u>HINT 1</u>: </b><i>For first question to be moved to last, select then Change. The first will now be the next to last number. Click the last number, and move to the next to last number. Click Change, and first will now be last.</i><br>"; this.hint_2 = "<b><u>HINT 2</u>: </b><i>For #1 to be #10, select #1 and #11 then change. #1 will now be #10.</i><br>"; this.hint_3 = "<b><u>HINT 3</u>: </b><i> For #10 to be #1, select #10 and #1 then change. #10 will now be #1.</i><br>"; this.note_1 = "<b>NOTE: </b>Inactive questions appear here and are part of the order, but will not appear or be counted/numbered when taken.<br>"; this.warn_1 = "<b>**</b><i>Questions out of order? Reordering & editing questions repeatedly may cause questions sequence to vary, though accurately numbered. To fix, click arrow button and select survey to reload from last save.</i>"; }; this.questionArchive = function( ){ this.id = "id"; this.test_id = "test_id"; this.status = "status"; this.question = "question"; this.type = "type"; this.choices_1 = "choices_1"; this.answer = "answer"; this.image = "image"; this.comment = "comment"; this.question_order = "question_order"; var requiredFeild = htmlBox.buildElement( "*", "b", "class='red-alert'" ); this.status_instruction = requiredFeild + "Status: <span class='mini_survey_text'>Do you want this 'active' or 'inactive'? Questions should be set to active, unless a question is to not be used. Active questions will only appear on site if survey or test is set to active.</span>"; this.test_id_instruction = requiredFeild + "Test Id: <span class='mini_survey_text'>Select from survey and/or test names below. If a name is not in the list, make sure you have first created the survey or test information.</span>"; this.question_instruction = requiredFeild + "Put your survey or test question here." + requiredFeild + requiredFeild; this.type_instruction = requiredFeild + "What type of input selector do you want? <span class='mini_survey_text'>Radio button means only 1 choice or answer from user, ie. true or false. Checkbox means they can select as many choices as they wish, from one to all.</span>"; this.answer_instruction = "answer_instruction"; this.choices_instruction = requiredFeild + "Enter in all the choices you wish to present to the user during the survey or test. <span class='mini_survey_text'>If a quiz, click the box to the left to mark a choice as an answer. If a checkbox quiz, mark multiple choices for answers. To delete a choice, click the red X to the right.</span>"+requiredFeild + requiredFeild ; this.image_instruction = "Place here full Url of image if one. <span class='mini_survey_text'>Images will be displayed at width of 20em. No height limitations have been set, allowing for a vertical picture with multiple images to be displayed to the right of the choices. Use discression. http(s):// full urls are recommended. Must contain a domain.</span>"; this.comment_instruction = "Place here a short comment about the image or an image title, if image used."+ requiredFeild + requiredFeild ; this.warn0_instruction = requiredFeild + "Required feild."; this.warn1_instruction = requiredFeild + requiredFeild + "Special characters will be disabled, may increase character count."; }; this.surveyArchive = function( ){ this.id = "id"; this.status = "status"; this.form_type = "form_type"; this.page_name = "page_name"; this.survey_name = "survey_name"; this.survey_title = "survey_title"; this.user_name = "user_name"; this.user_level = "user_level"; this.timer = "timer"; this.results = "results"; this.info_titles = "info_titles"; this.overview = "overview"; this.purpose = "purpose"; this.time_length = "time_length"; this.closing = "closing"; this.closing_link = "closing_link"; this.author = "author"; this.release_date = "release_date"; this.info_image = "info_image"; this.image_comment = "image_comment"; var requiredFeild = htmlBox.buildElement( "*", "b", "class='red-alert'" ); this.status_instruction = requiredFeild + "Status: <span class='mini_survey_text'>Do you want this 'active' or 'inactive'? WARNING: Do Not activate until you want the information to appear on the site. Set to 'inactive' until your survey or test is complete.</span>"; this.form_type_instruction = requiredFeild + "Form Type: <span class='mini_survey_text'>Is this a Survey or a Test?</span>"; this.info_titles_instruction = requiredFeild + "Info Titles: <span class='mini_survey_text'>Selecting 'true' will put a title at the start Overview will have 'Overview:', Purpose will show 'Purpose:'. Selecting 'false' will hide titles.</span>"; this.page_name_instruction = requiredFeild + "Page Name: <span class='mini_survey_text'>This is the name of the url page name. www.mysite.com/page-name should be entered as 'page-name'. Site must do url rewrites. Unacceptable page names are: page-name.html, page-name.php, or page-name.php?id=2. This must not be left blank. Maximum of 5 active tests/surveys per page.</span>"; this.survey_name_instruction = requiredFeild + "Survey Name: <span class='mini_survey_text'>This is url/code friendly name of the individual survey or test for indexing. Example: My New Customer Survery => Name: new-customer-survey or new_customer_survey or newcustomersurvey or any variation.</span>"; this.survey_title_instruction = requiredFeild + "Survey Title: <span class='mini_survey_text'>This is the full title of the survey or test you want to appear at the title on the website. This is not affected by the Info Titles, and appears always.</span>"+requiredFeild + requiredFeild; this.user_name_instruction = requiredFeild + "User Name - Email: <span class='mini_survey_text'>Do you need to identify the user-taker? This field scans for valid email addresses. Reqired will not allow the user to take the survey or test until an email is entered. Optional shows input block, will continue if empty or invalid entry, but will only save valid emails in the database. Anonymous offers no id input.</span>"+requiredFeild; this.overview_instruction = requiredFeild + "Overview: <span class='mini_survey_text'>This is a general overview of the test or survey or a welcome message. All here will appear within a single paragraph. Info Titles option affects this option.</span>" + requiredFeild + requiredFeild; this.user_level_instruction = "User Level: <span class='mini_survey_text'>fill this only if a test has a difficulty level."; this.time_length_instruction = "Time Length: <span class='mini_survey_text'>This is general information about how much time is needed to take the test or survey. Or can be used to let users know how long till receiving response. Leave blank if no information of this type. All here will appear within a single paragraph. Info Titles option affects this option. Leave blank if not needed.</span>" + requiredFeild + requiredFeild ; this.timer_instruction = "Timer: <span class='mini_survey_text'>Do you want a timer? Enter 'Minutes:Seconds' (60:00 = 1 hr, 5:30 = 5 min 30 secs). Test or Survey will finish and submit when timer runs out. Leave blank if you do not want a timer.</span>"; this.results_instruction = "Results: <span class='mini_survey_text'>This applies to test only where answers are compared. If you want to have test results at the end, set to 'active'. Showing test results gives number correct, total number, percent score, shows all questions, only the users anser, and if 'correct' or 'incorrect'.</span>"; this.purpose_instruction = "Purpose: <span class='mini_survey_text'>what is the purpose of this test, survey or the purpose the user's input. Leave blank if no information of this type. All here will appear within a single paragraph. Info Titles option affects this option. Leave blank if not needed.</span>"+requiredFeild + requiredFeild; this.author_instruction = "Author: <span class='mini_survey_text'>Who created this survey or test, or the name of the organization posting the survey or test. Leave blank if no information of this type. All here will appear within a single paragraph. Info Titles option affects this option. Leave blank if not needed.</span>" + requiredFeild + requiredFeild ; this.release_date_instruction = "Release Date: <span class='mini_survey_text'>When was this survey first posted and/or last updated. Leave blank if no information of this type. All here will appear within a single paragraph. Info Titles option affects this option. Leave blank if not needed.</span>" + requiredFeild + requiredFeild; this.closing_instruction = "*Closing Information: <span class='mini_survey_text'>This is what will be shown at the end of the survey or test. All here will appear within a single paragraph. Info Titles option DOES NOT affect this option.</span>" + requiredFeild + requiredFeild; this.closing_link_instruction = "Closing Link: <span class='mini_survey_text'>have a special offer, coupon or page you want to show people when finished taking the test, place it here. http(s):// full urls are recommended. Must contain a domain. Can have .php endings like: mysite.com/reward.php?id=survey. Opens in new Window. Leave blank if no offers. Leave blank if not needed.</span>"; this.info_image_instruction = "Place here full Url of image if one. <span class='mini_survey_text'>Images will be displayed at width of 20em. No height limitations have been set, allowing for a vertical picture with multiple images to be displayed to the right of the choices. Use discression. http(s):// full urls are recommended. Must contain a domain.</span>"; this.image_comment_instruction = "Place here a short comment about the image or an image title, if image used."+ requiredFeild + requiredFeild ; this.warn0_instruction = requiredFeild + "Required feild."; this.warn1_instruction = requiredFeild + requiredFeild + "special characters will be disabled, and will decrease character total count by 2 characters each."; return this; }; this.buildEnum = function( temp , option){ var html = ""; var tempCheck = toolBox.validateObject( "order_", temp ); if(tempCheck==true){ var i = 0; html += htmlBox.buildOption( i, temp ); while(i<option){ i++; html += htmlBox.buildOption( i, temp ); }; var tempID = temp; }; if(temp == "user_name"){ html += htmlBox.buildOption( "anonymous", temp ); html += htmlBox.buildOption( "optional", temp ); html += htmlBox.buildOption( "required", temp ); var tempID = temp; }; if(temp == "form_type"){ html += htmlBox.buildOption( "", temp ); html += htmlBox.buildOption( "Survey", temp ); html += htmlBox.buildOption( "Quiz", temp ); var tempID = temp; }; if(temp == "user_level"){ html += htmlBox.buildOption( "Not Applicable", temp ); html += htmlBox.buildOption( "Very Difficult", temp ); html += htmlBox.buildOption( "Difficult", temp ); html += htmlBox.buildOption( "Advanced", temp ); html += htmlBox.buildOption( "Challenging", temp ); html += htmlBox.buildOption( "Moderate", temp ); html += htmlBox.buildOption( "Intermediate", temp ); html += htmlBox.buildOption( "Easy", temp ); html += htmlBox.buildOption( "Basic", temp ); var tempID = temp; }; if(temp == "status" || temp == "results"){ html += htmlBox.buildOption( "", temp ); html += htmlBox.buildOption( "inactive", temp ); html += htmlBox.buildOption( "active", temp ); var tempID = temp; }; if(temp == "type"){ html += htmlBox.buildOption( "", temp ); html += htmlBox.buildOption( "radio", temp ); html += htmlBox.buildOption( "checkbox", temp ); var tempID = temp; }; if(temp == "login"){ html += htmlBox.buildOption( "", temp ); html += htmlBox.buildOption( "text", temp ); html += htmlBox.buildOption( "textarea", temp ); html += htmlBox.buildOption( "email", temp ); html += htmlBox.buildOption( "url", temp ); html += htmlBox.buildOption( "password", temp ); var tempID = temp; }; if(temp == "info_titles"){ html += htmlBox.buildOption( "", temp ); html += htmlBox.buildOption( true, temp ); html += htmlBox.buildOption( false, temp ); var tempID = temp; }; if(temp == "timer"){ var i = 0; if(option=="minutes"){ while(i <=120){ html += htmlBox.buildOption( i, option ); i++; }; }; if(option=="seconds"){ while(i <=59){ html += htmlBox.buildOption( i, option ); i++; }; }; var tempID = option; temp = tempID; }; if(temp== "test_id" || temp=="survey_name"){ var tempID = temp; html += htmlBox.buildOption( "", temp ); $.each(option["test"], function(key,val){ if($.trim(val)!="" && option["type"][key]!=undefined){ html += htmlBox.buildOption( val+" : "+option["type"][key].toLowerCase(), temp ); }; }); }; var selectHTML = htmlBox.buildSelectId( html, temp, tempID, "" ); return selectHTML ; }; this.regExpSet = function( ){ this.checkSpace = /\s/g ; this.checkSpacePlus = /\s{2,100}/g ; this.checkInteger = /^[\d]+$/ ; this.checkIllegals = /(((\|){1}(\:){1}(\|){1})|((\|){1}(\=){1}(\|){1})|((\|){1}(\-){1}(\|){1})|((\|){1}(\_){1}(\|){1})|((\|){1}(\:){1}(\-){1}(\:){1}(\|){1})|((\|){1}(\:){1}(\=){1}(\:){1}(\|){1})|((\|){1}(\-){1}(\_){1}(\-){1}(\|){1})|((\|){1}(\_){1}(\-){1}(\_){1}(\|){1})|((\|){1}(\_){1}(\:){1}(\_){1}(\|){1}) )/g; this.checkDataName = /[\"\'\\\/\¡\¿\“\”\‘\’\«\»\s\¢\©\÷\>\<\µ\·\¶\±\:\;\£\®\§\™\¥\%\(\)\*\+\,\.\=\?\[\]\{\|\}\~\…\¦\¬\•\¼\½\¾\á\à\â\å\ã\ä\æ\ç\é\è\ê\ë\í\ì\î\ï\ñ\ó\ò\ô\ø\õ\ö\ß\ú\ù\û\ü\ÿ\´\Á\À\Â\Å\Ã\Ä\Æ\Ç\É\È\Ê\Ë\Í\Ì\Î\Ï\Ñ\Ó\Ò\Ô\Ø\Õ\Ö\Ú\Ù\Û\Ü\`]?/g ; this.checkLiteralString = /([.*+?^=!:${}()|\[\]\/\\])/g; this.recheckLiteralString = /\\/g; this.checkSsn = /^\d{3}([\- ]?)\d{2}([\- ]?)\d{4}$/; this.checkEmail = /^(\w+[\-\.])*\w+@(\w+\.)+[A-Za-z]+$/; this.checkUrl = /^((ftp|http|https):\/\/){0,1}((((WWW|www)\.){0,1}((([a-zA-Z0-9\_\-]){2,200}(\.){1}){1}(([a-zA-Z]{2}\.{1}){0,1}((aero|biz|com|coop|info|museum|net|org|pro|travel|gov|edu|mil|int){1}){1}){1}){1}){0,1}(\blocalhost\b){0,1}){1}(((\/){1}([a-zA-Z0-9\/\_\-\.\&\?\=]){1,200}){0,20})?$/; this.checkPassword = /^[A-Za-z\d]{6,24}$/; this.checkPhone = /^\d{3}([\- ]?)\d{3}([\- ]?)\d{4}$/; this.checkPhoneCntry = /^\d{1,5}([\- ]?)\d{3}([\- ]?)\d{3}([\- ]?)\d{4}$/; this.checkPhoneExit = /^\d{1,4}([\- ]?)\d{1,5}([\- ]?)\d{3}([\- ]?)\d{3}([\- ]?)\d{4}$/; this.cleanSsn = "$1-$2-$3"; this.cleanPhoneCntry = "$1-$2-$3-$4"; this.cleanPhoneExit = "$1-$2-$3-$4-$5"; this.cleanLiteralString = "\\$1"; this.recleanLiteralString = ""; this.cleanSpacePlus = " "; this.cleanSpace = " "; this.char_0 = "–"; this.spchar_0 = "&#8211"; this.char_1 = "—"; this.spchar_1 = "&#8212;"; this.char_2 = "¡"; this.spchar_2 = "&#161;"; this.char_3 = "¿"; this.spchar_3 = "&#191;"; this.char_4 = '"' ; this.spchar_4 = "&#34;"; this.char_5 = "“"; this.spchar_5 = "&#8220;"; this.char_6 = "”"; this.spchar_6 = "&#8221;"; this.char_7 = "'"; this.spchar_7 = "&#39;"; this.char_8 = "‘"; this.spchar_8 = "&#8216;"; this.char_9 = "’"; this.spchar_9 = "&#8217;"; this.char_10 = "«"; this.spchar_10 = "&#171;"; this.char_11 = "»"; this.spchar_11 = "&#187;"; this.char_12 = " "; this.spchar_12 = "&#160;"; this.char_13 = "¢"; this.spchar_13 = "&#162;"; this.char_14 = "©"; this.spchar_14 = "&#169;"; this.char_15 = "÷"; this.spchar_15 = "&#247;"; this.char_16 = ">"; this.spchar_16 = "&#62;"; this.char_17 = "<"; this.spchar_17 = "&#60;"; this.char_18 = "µ"; this.spchar_18 = "&#181;"; this.char_19 = "·"; this.spchar_19 = "&#183;"; this.char_20 = "¶"; this.spchar_20 = "&#182;"; this.char_21 = "±"; this.spchar_21 = "&#177;"; this.char_22 = "€"; this.spchar_22 = "&#8364;"; this.char_23 = "£"; this.spchar_23 = "&#163;"; this.char_24 = "®"; this.spchar_24 = "&#174;"; this.char_25 = "§"; this.spchar_25 = "&#167;"; this.char_26 = "™"; this.spchar_26 = "&#153;"; this.char_27 = "¥"; this.spchar_27 = "&#165;"; this.char_28 = "/"; this.spchar_28 = "&#47;"; this.char_29 = "%"; this.spchar_29 = "&#37;"; this.char_30 = "("; this.spchar_30 = "&#40;"; this.char_31 = ")"; this.spchar_31 = "&#41;"; this.char_32 = "*"; this.spchar_32 = "&#42;"; this.char_33 = "+"; this.spchar_33 = "&#43;"; this.char_34 = ","; this.spchar_34 = "&#44;"; this.char_35 = "-"; this.spchar_35 = "&#45;"; this.char_36 = "."; this.spchar_36 = "&#46;"; this.char_37 = ":"; this.spchar_37 = "&#58;"; this.char_39 = "="; this.spchar_39 = "&#61;"; this.char_40 = "?"; this.spchar_40 = "&#63;"; this.char_41 = "["; this.spchar_41 = "&#91;"; this.char_42 = "\\"; this.spchar_42 = "&#92;"; this.char_43 = "]"; this.spchar_43 = "&#93;"; this.char_44 = "_"; this.spchar_44 = "&#94;"; this.char_45 = "_"; this.spchar_45 = "&#95;"; this.char_46 = "{"; this.spchar_46 = "&#123;"; this.char_47 = "|"; this.spchar_47 = "&#124;"; this.char_48 = "}"; this.spchar_48 = "&#125;"; this.char_49 = "~"; this.spchar_49 = "&#126;"; this.char_50 = "…"; this.spchar_50 = "&#133;"; this.char_51 = "–"; this.spchar_51 = "&#150;"; this.char_52 = "—"; this.spchar_52 = "&#151;"; this.char_53 = "¦"; this.spchar_53 = "&#166;"; this.char_54 = "¬"; this.spchar_54 = "&#172;"; this.char_55 = "•"; this.spchar_55 = "&#8226;"; this.char_56 = "¼"; this.spchar_56 = "&#188;"; this.char_57 = "½"; this.spchar_57 = "&#189;"; this.char_58 = "¾"; this.spchar_58 = "&#190;"; this.char_59 = "á"; this.spchar_59 = "&#225;"; this.char_60 = "à"; this.spchar_60 = "&#224;"; this.char_61 = "â"; this.spchar_61 = "&#226;"; this.char_62 = "å"; this.spchar_62 = "&#229;"; this.char_63 = "ã"; this.spchar_63 = "&#227;"; this.char_64 = "ä"; this.spchar_64 = "&#228;"; this.char_65 = "æ"; this.spchar_65 = "&#230;"; this.char_66 = "ç"; this.spchar_66 = "&#231;"; this.char_67 = "é"; this.spchar_67 = "&#233;"; this.char_68 = "è"; this.spchar_68 = "&#232;"; this.char_69 = "ê"; this.spchar_69 = "&#234;"; this.char_70 = "ë"; this.spchar_70 = "&#235;"; this.char_71 = "í"; this.spchar_71 = "&#237;"; this.char_72 = "ì"; this.spchar_72 = "&#236;"; this.char_73 = "î"; this.spchar_73 = "&#238;"; this.char_74 = "ï"; this.spchar_74 = "&#239;"; this.char_75 = "ñ"; this.spchar_75 = "&#241;"; this.char_76 = "ó"; this.spchar_76 = "&#243;"; this.char_77 = "ò"; this.spchar_77 = "&#242;"; this.char_78 = "ô"; this.spchar_78 = "&#244;"; this.char_79 = "ø"; this.spchar_79 = "&#248;"; this.char_80 = "õ"; this.spchar_80 = "&#245;"; this.char_81 = "ö"; this.spchar_81 = "&#246;"; this.char_82 = "ß"; this.spchar_82 = "&#223;"; this.char_83 = "ú"; this.spchar_83 = "&#250;"; this.char_84 = "ù"; this.spchar_84 = "&#249;"; this.char_85 = "û"; this.spchar_85 = "&#251;"; this.char_86 = "ü"; this.spchar_86 = "&#252;"; this.char_87 = "ÿ"; this.spchar_87 = "&#255;"; this.char_88 = "´"; this.spchar_88 = "&#180;"; this.char_89 = "Á"; this.spchar_89 = "&#193;"; this.char_90 = "À"; this.spchar_90 = "&#192;"; this.char_91 = "Â"; this.spchar_91 = "&#194;"; this.char_92 = "Å"; this.spchar_92 = "&#197;"; this.char_93 = "Ã"; this.spchar_93 = "&#195;"; this.char_94 = "Ä"; this.spchar_94 = "&#196;"; this.char_95 = "Æ"; this.spchar_95 = "&#198;"; this.char_96 = "Ç"; this.spchar_96 = "&#199;"; this.char_97 = "É"; this.spchar_97 = "&#201;"; this.char_98 = "È"; this.spchar_98 = "&#200;"; this.char_99 = "Ê"; this.spchar_99 = "&#202;"; this.char_100 = "Ë"; this.spchar_100 = "&#203;"; this.char_101 = "Í"; this.spchar_101 = "&#205;"; this.char_102 = "Ì"; this.spchar_102 = "&#204;"; this.char_103 = "Î"; this.spchar_103 = "&#206;"; this.char_104 = "Ï"; this.spchar_104 = "&#207;"; this.char_105 = "Ñ"; this.spchar_105 = "&#209;"; this.char_106 = "Ó"; this.spchar_106 = "&#211;"; this.char_107 = "Ò"; this.spchar_107 = "&#210;"; this.char_108 = "Ô"; this.spchar_108 = "&#212;"; this.char_109 = "Ø"; this.spchar_109 = "&#216;"; this.char_110 = "Õ"; this.spchar_110 = "&#213;"; this.char_111 = "Ö"; this.spchar_111 = "&#214;"; this.char_112 = "Ú"; this.spchar_112 = "&#218;"; this.char_113 = "Ù"; this.spchar_113 = "&#217;"; this.char_114 = "Û"; this.spchar_114 = "&#219;"; this.char_115 = "Ü"; this.spchar_115 = "&#220;"; this.char_116 = "`"; this.spchar_116 = "&#96;"; }; }; function _controller(){ this.launchEdit = function( tempLaunch ){ if(tempLaunch==true){ localConfig = new launch.setDomain( loadPathAdjustment ); user = new launch.surveyConfigUser( ); currentTest = new launch.surveyConfigTests( ); system_opts = new launch.surveyConfigLocal( ); if(localConfig.domain1){ setupBox = new setupTools( ); toolBox = new surveyTools( ); htmlBox = new buildHtml( ); editTestInfo = new launch.editTest(); connect = new ajaxConnections( ); var i1=0; var readURL = setupBox.readURL(); if (readURL.toLowerCase().indexOf("admin") >= 0){ user.adminCheck1 = true ; var temp1 = ('#survey_admin-content').length ; var temp2 = $('#survey-content').length; if (temp1 >0){ if(temp2 <=0 ){ user.adminCheck2 = true ; if(user.adminCheck1 == true && user.adminCheck1 == true){ admin = new _Admin(); fixerBox = new launch.regExpSet(); admin = admin.urlAdmin(); var tempRead = readURL ; tempRead = setupBox.whileFix( tempRead ); if( tempRead != readURL){ readURL = tempRead ; var tempHTML = htmlBox.buildIdElement( "", "div", "survey-content", ""); $("#survey_admin-content").empty().append(tempHTML); return true; }; }; }; }; }; }; }; }; this.compress = function( ){ localConfig.compressed = ""; loader.surveyPageGet(); var stopInterval = setInterval(function() { if(!localConfig.compressed || localConfig.compressed.length < 1){ $('#survey-setup').trigger('click'); } else{ if(localConfig.compressed.length >0 ){ $("#survey-setup").remove(); clearInterval(stopInterval); }; }; }, 10); return true; }; this.uncompress = function( tempAction ){ var i=0; var stopIntervalUncompress = setInterval(function() { if(localConfig.compressed.length >0 ){ tempArray = toolBox.parseDataLoad1(localConfig.compressed); $.each(tempArray, function(key, val){ i++; if( $.trim(val) != "" ){ tempArray[tempAction] = toolBox.parseDataSplit(val); $.each(tempArray[tempAction], function(key2, val2){ tempArray[tempAction][key2] = toolBox.parseCustomSplit(val2,"|:|"); var tempKey=''; $.each(tempArray[tempAction][key2], function(key3, val3){ val3 = $.trim(val3); if(key3==0){ tempKey = val3; }; if(key3==1){ system_opts = launch.themeFill( i, tempKey, val3 ); }; }); }); }; }); system_opts.set_complete=true ; tempArray[tempAction]=undefined; clearInterval(stopIntervalUncompress ); }; }, 10); }; this.decompress = function( ){ var tempKey ; var tempval ; system_opts.set_complete=false; var stopIntervalDecompress = setInterval(function() { if(localConfig.compressed.length >0 ){ var tempArray = toolBox.parseDataLoad2(localConfig.compressed); tempArray["info"] = toolBox.parseDataLoad1(tempArray[0]); $.each(tempArray["info"], function(key, val){ tempArray["parse_info"] = toolBox.parseCustomSplit(val,"|:|"); tempKey = tempArray["parse_info"][0]; tempval = tempArray["parse_info"][1]; if( (tempKey!=undefined && tempKey!="") && (tempval!=undefined && tempval!="") ){ editSurveyInfo[tempKey] = tempval; }; }); if(tempArray[1] && tempArray[1]!=''){ tempArray["questions"] = toolBox.parseDataLoad1(tempArray[1]); $.each(tempArray["questions"], function(key2, val2){ tempArray["parse_question"] = toolBox.parseCustomSplit(val2,"|:|"); tempKey = tempArray["parse_question"][0]; tempval = tempArray["parse_question"][1]; if( (tempKey!=undefined && tempKey!="") && (tempval!=undefined && tempval!="") ){ editSurvey[tempKey] = tempval; }; }); }; system_opts.set_complete=true ; tempArray = undefined; clearInterval(stopIntervalDecompress ); }; }, 10); }; this.testSetter = function(objTemp, pageKey, viewKey){ localConfig.compressed = ""; system_opts.set_complete=false; var tempTest = []; loader.adminSurveyList(); var tempCheck1 = controller.compress(); var setIntervalTestName = setInterval(function() { if(tempCheck1==true && localConfig.compressed !=""){ if(localConfig.compressed == "no_test"){ var tempHTML = htmlBox.buildElement( "No surveys or tests have been created yet. Please create a test", "h1", "" ); tempHTML += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); } else{ tempTest["parse"] = toolBox.parseDataLoad1(localConfig.compressed); tempTest["test"] = toolBox.parseDataSplit(tempTest["parse"][0]); tempTest["type"] = toolBox.parseDataSplit(tempTest["parse"][1]); var tempHTML = view[viewKey](objTemp, tempTest); tempTest=undefined; }; render.page( pageKey, tempHTML ); system_opts.set_complete=true ; clearInterval( setIntervalTestName ); }; }, 10); }; this.publishSetter = function(objTemp, pageKey, viewKey, openClass){ localConfig.compressed = ""; system_opts.set_complete=false; var tempTest = []; loader.adminPublisherGet(openClass); var tempCheck1 = controller.compress(); var setIntervalTestName = setInterval(function() { if(tempCheck1==true && localConfig.compressed !=""){ if( openClass=="publish_tracking"){ tempTest["parse"] = toolBox.parseDataLoad1(localConfig.compressed); tempTest["users"] = toolBox.parseCustomSplit(tempTest["parse"][0],"|:|"); tempTest["total"] = $.trim(tempTest["parse"][1]); }; if( openClass=="publish_results"){ tempTest["tests"] = toolBox.parseCustomSplit(localConfig.compressed,"|:|");}; if( openClass=="publish_tracer"){ tempTest["number"] =pageKey; tempTest["action"] ="publish_tracer"; pageKey=openClass; }; if( openClass=="publish_tests"){ tempTest["number"] =pageKey; tempTest["action"] ="publish_tests"; pageKey=openClass; }; var tempHTML = view[viewKey](objTemp, tempTest, openClass); tempTest=undefined; if(localConfig.compressed == "error"){ tempHTML += htmlBox.buildElement( "Nothing new to publish at this time.", "h3", " class='survey_timer'" ); }; $("#set-surveyor h3").remove(); render.page( pageKey, tempHTML ); system_opts.set_complete=true ; clearInterval( setIntervalTestName ); }; }, 10); }; this.fileSetter = function(tempNum, pageKey, viewKey, openClass){ localConfig.compressed = ""; system_opts.set_complete=false; var tempTest = []; loader.adminPublisherCreate(openClass, tempNum, pageKey); var tempCheck1 = controller.compress(); var setIntervalTestName = setInterval(function(){ if(tempCheck1==true && localConfig.compressed !=""){ $("input[name='"+$.trim(pageKey)+":"+$.trim(tempNum)+"']").addClass("survey_button_disabled").prop('disabled', true).val("Done "+$.trim(pageKey)+" Button #"+$.trim(tempNum)); if( openClass=="publish_tracer"){ tempTest["number"] =pageKey; tempTest["action"] ="publish_tracer"; pageKey=openClass; }; if( openClass=="publish_tests"){ tempTest["number"] =pageKey; tempTest["action"] ="publish_tests"; pageKey=openClass; }; system_opts.set_complete=true ; clearInterval( setIntervalTestName ); }; }, 10); }; }; function _Loader(){ this.adminPageCheck = function( ){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('#survey-content').append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.loadSurveyConfig( temp, "defaults_get", "" , localConfig.domain1 , localConfig.filePathAdj, "NULL", "NULL" ); }; }; this.adminSurveyList = function( ){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('#survey-content').append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.loadSurveyConfig( temp, "survey_list_get", "" , localConfig.domain1 , localConfig.filePathAdj, "NULL", "NULL" ); }; }; this.adminSurveyEdit = function( ){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('#survey-content').append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "get_test" , "", localConfig.domain1 , localConfig.filePathAdj, "NULL", editSurveyInfo.survey_name, "NULL", "warn_message" ); }; }; this.adminOrderEdit = function( tempOrder ){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('#survey-content').append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "reorder_questions" , "", localConfig.domain1 , localConfig.filePathAdj, "NULL", tempOrder, "NULL", "warn_message" ); }; }; this.adminPublisherGet = function ( openClass ){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('.info_box').empty().append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.loadPublishConfig( temp, openClass, "" , localConfig.domain1 , localConfig.filePathAdj, "NULL", "NULL", "warn_message" ); }; }; this.adminPublisherCreate = function ( openClass, tempNum, pageKey){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('.info_box').append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.loadPublishConfig( temp, openClass, pageKey , localConfig.domain1 , localConfig.filePathAdj, tempNum, 1000, "warn_message" ); }; }; this.adminDownloadCreate = function ( openClass, tempNum, pageKey){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('.info_box').append( temp ); temp = connect.preloadConfig(); if (temp==1){ connect.loadPublishConfig( temp, openClass, pageKey , localConfig.domain1 , localConfig.filePathAdj, tempNum, 1000, "warn_message" ); }; }; this.surveyPageGet = function( ){ $('#survey-setup').on('click', function() { var tempContent = $(this).text(); localConfig.compressed = $.trim(tempContent); }); }; }; function ajaxConnections( ){ this.preloadConfig = function(){ activeAjaxConnections++; return activeAjaxConnections; }; this.loadSurveyConfig = function( temp, tempAction, tempPg, domainNM, fileADJ, additional, userId ){ activeAjaxConnections = temp; if (window.XMLHttpRequest){ xmlhttp=new XMLHttpRequest(); } else{ xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"); }; xmlhttp.onreadystatechange=function(){ if (xmlhttp.readyState==4 && xmlhttp.status==200){ var tempVAL = xmlhttp.responseText; tempVAL = $.trim(tempVAL); tempVAL = tempVAL.slice( +1 , -1 ); activeAjaxConnections--; if(tempVAL == 'no_page'){ tempVAL = "Admin has been set to OFF in the system defaults table of the database. Contact server administrator to turn admin ON."; document.getElementById("survey-content").innerHTML = tempVAL;} else{ document.getElementById("survey-setup").innerHTML = tempVAL; temp = setupBox.whileTime(activeAjaxConnections); while( temp==false ){ continue; }; if( temp==true ){ temp=undefined; }; }; }; }; var tempGET= "http://" + domainNM + fileADJ + "/Surveyor-Elite/php/survey_admin.php?action="+ tempAction +"&index="+ tempPg +"&additional="+ additional +"&UiD="+ userId; xmlhttp.open("GET", tempGET ,true); xmlhttp.send(); }; this.setSurveyConfig = function( temp, tempAction, tempPg, domainNM, fileADJ, additional, submission, results, openClass ){ activeAjaxConnections = temp; if (window.XMLHttpRequest){ xmlhttp=new XMLHttpRequest(); } else{ xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"); }; xmlhttp.onreadystatechange=function(){ if (xmlhttp.readyState==4 && xmlhttp.status==200){ var tempVAL = xmlhttp.responseText; tempVAL = $.trim(tempVAL); tempVAL = tempVAL.slice( +1 , -1 ); activeAjaxConnections--; if( tempVAL === "no_question" ){ $("."+openClass).empty().append("<span class='red-alert'>Error editing question order. Please contact Admin.</span>"); $("#survey_name").addClass("input_checker_required"); }; if( tempVAL === "no_info" ){ $("."+openClass).empty().append("<span class='red-alert'>Error editing information. Please contact Admin.</span>"); $("#survey_name").addClass("input_checker_required"); }; if( tempVAL === "no_edit_question" ){ $("."+openClass).empty().append("<span class='red-alert'>Error editing question. Please contact Admin.</span>"); $("#survey_name").addClass("input_checker_required"); }; if( tempVAL === "test_exists" ){ $("."+openClass).empty().append("<span class='red-alert'>Survey Name already exists. Please edit your Survey Name.</span>"); $("#survey_name").addClass("input_checker_required"); }; if( tempVAL === "new_info" ){ var tempArray=["status","form_type","user_level","user_name","timer","results","info_titles","page_name","survey_name","survey_title","author","release_date","overview","purpose","time_length","closing","closing_link","image_comment","info_image"]; $.each(tempArray, function(key,val){ $(".remove_"+val).remove(); $("#"+val+"_holder ").remove(); }); $("#set-button").remove(); $("blockquote").remove(); $("."+openClass).empty().append("<h3 class='saving_alert'>Done Saving. You may make additional changes to this information page in the 'edit' section.</h3>"); }; if( tempVAL === "new_question" ){var tempArray=["test_id", "question", "comment", "image", "type", "status","choices"]; $.each(tempArray, function(key,val){ $(".remove_"+val).remove(); $("#"+val+"_holder ").remove(); }); $("#set-button").remove(); $("blockquote").remove(); $("."+openClass).empty().append("<h3 class='saving_alert'>Done Saving. You may make additional changes to this information page in the 'edit' section.</h3>"); }; if( tempVAL === "edit_question" || tempVAL === "edit_info" ){ $("."+openClass).empty().append("<h3 class='saving_alert'>Done Saving. You may make additional changes at this time.</h3>"); }; if( tempVAL === "defaults_saved" ){ $("."+openClass).empty().append("<h3 class='saving_alert'>Done Saving. You may make additional changes at this time.</h3>"); } else{ if($("#survey-setup").length){ /**/ } else{temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('#survey-content').append( temp );}; if(tempVAL==undefined || tempVAL=='undefined' || typeof tempVAL=='undefined'){ tempVAL='none';}; document.getElementById("survey-setup").innerHTML = tempVAL; temp = setupBox.savingTime(activeAjaxConnections,openClass); while( temp==false ){ continue; }; if( temp==true ){ temp=undefined; }; }; }; }; var tempGET= "http://" + domainNM + fileADJ + "/Surveyor-Elite/php/survey_admin.php?action="+ tempAction +"&index="+ tempPg +"&additional="+ additional +"&submission="+ submission +"&results="+ results; xmlhttp.open("GET", tempGET ,true); xmlhttp.send(); }; this.loadPublishConfig = function( temp, tempAction, tempPg, domainNM, fileADJ, additional, userId, openClass ){ activeAjaxConnections = temp; if(additional=="results_download" || additional=="tracking_download"){ var rPl=additional; additional="http://" + domainNM + fileADJ + "/Surveyor-Elite/php/_download/"+additional+".php";}; if (window.XMLHttpRequest){ xmlhttp=new XMLHttpRequest(); } else{ xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"); }; xmlhttp.onreadystatechange=function(){ if (xmlhttp.readyState==4 && xmlhttp.status==200){ var tempVAL = xmlhttp.responseText; tempVAL = $.trim(tempVAL); tempVAL = tempVAL.slice( +1 , -1 ); activeAjaxConnections--; if(tempVAL == "no_publish"){ $("#set-surveyor h3").remove(); $("#set-surveyor").append("<h3 class='saving_alert'>Failure to find files to publish. Reload page to update.</h3>"); } else if(tempVAL == "no_folder"){ $("#set-surveyor h3").remove(); $("#set-surveyor").append("<h3 class='saving_alert'>Failure to find folder to Zip. Make sure files have been published.</h3>"); } else if(tempVAL == "no_zip"){ $("#set-surveyor h3").remove(); $("#set-surveyor").append("<h3 class='saving_alert'>Failure to find Zip Archive. Make sure files have been Zipped.</h3>"); } else{ document.getElementById("survey-setup").innerHTML = tempVAL; temp = setupBox.savingTime(activeAjaxConnections,openClass); while( temp==false ){ continue; }; if( temp==true ){ if(rPl!=undefined){var tempVAL = toolBox.cleanExpression( tempVAL, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $("#"+rPl).replaceWith(tempVAL);} else if( tempVAL=="Zip_success"){ $("#set-surveyor h3").remove(); var tempHTML = htmlBox.buildElement( "<i>Done Zipping Folder...Please Continue and Download.</i>", "h3", " class='survey_timer'" ); $("."+openClass).empty().append(tempHTML); } else if( tempVAL=="Publish_success"){ $("#set-surveyor h3").remove(); var tempHTML = htmlBox.buildElement( "<i>Done Publishing XML Files...Please Continue and Zip Folder.</i>", "h3", " class='survey_timer'" ); $("."+openClass).empty().append(tempHTML); } else{/*skip*/}; temp=undefined; }; }; }; }; var tempGET= "http://" + domainNM + fileADJ + "/Surveyor-Elite/php/survey_admin.php?action="+ tempAction +"&index="+ tempPg +"&additional="+ additional +"&UiD="+ userId; xmlhttp.open("GET", tempGET ,true); xmlhttp.send(); }; }; function setupTools( ){ this.whileTime = function (tempSet){ var tempContinue = false; while(tempSet==1){ continue; }; var tempVAL2 = $('#survey-setup').text(); while(tempVAL2.length < 1){ tempVAL2 = $('#survey-setup').text(); tempContinue = false; }; if(tempVAL2.length >= 1){ tempContinue = true; return tempContinue ; }; }; this.savingTime = function (tempSet, openClass){ var tempContinue = false; while(tempSet==1){ continue; }; var tempVAL2 = $('#survey-setup').text(); tempVAL2=$.trim(tempVAL2); while(tempVAL2.length < 1){ $("."+openClass).append(".."); tempVAL2 = $('#survey-setup').text(); tempContinue = false; }; if(tempVAL2.length >= 1){ tempContinue = true; return tempContinue ; }; }; this.clickHashURL = function (){ var hash = $(this).attr('href'); location.hash = hash; hash = hash.replace("#", ""); return hash; }; this.readURL = function (){ var pathname = window.location.pathname; pathname = toolBox.parseNavSplit(pathname); var pathNameTotal = pathname.length; pathNameTotal = pathNameTotal - 1; var tempPath = pathname[pathNameTotal]; return tempPath; }; this.whileFix = function ( tempSet ){ var i=1; while( admin["fixer_"+i] ){ tempSet = tempSet.replace(admin["fixer_"+i], ""); i++ ; }; return tempSet ; }; }; function surveyTools( ){ this.parseDataLoad1 = function ( tempVar ){if(tempVar!=undefined){ var parsedTempVar = tempVar.split("|_-_|"); } else{parsedTempVar="";}; return parsedTempVar; }; this.parseDataLoad2 = function ( tempVar ){if(tempVar!=undefined){ var parsedTempVar = tempVar.split("|_:_|"); } else{parsedTempVar="";}; return parsedTempVar; }; this.parseDataSplit = function ( tempVar ){if(tempVar!=undefined){ var parsedTempVar = tempVar.split("|=|"); } else{parsedTempVar="";}; return parsedTempVar; }; this.parseKeySplit = function ( tempVar ){if(tempVar!=undefined){ var parsedTempVar = tempVar.split("|-|"); } else{parsedTempVar="";}; return parsedTempVar; }; this.parseNavSplit = function ( tempVar ){if(tempVar!=undefined){ var parsedTempVar = tempVar.split("/"); } else{parsedTempVar="";}; return parsedTempVar; }; this.parseCustomSplit = function ( tempVar, index ){if(tempVar!=undefined){ var parsedTempVar = tempVar.split( index ); }else{parsedTempVar="";}; return parsedTempVar; }; this.validateObject = function ( tempSubString, tempString ){ var temp = tempString.indexOf(tempSubString); if(temp >= 0 ){return true;} else {return false;}; }; this.cleanExpression = function ( tempVar, tempExp, tempReplace ){ var tempVar = tempVar.replace(fixerBox.checkIllegals, fixerBox.recleanLiteralString); tempVar = tempVar.replace(tempExp, tempReplace); return tempVar; }; this.cleanText = function ( tempVar ){ var i = 0 ; while(i<=120){ if(fixerBox["char_"+i]){ var pattern = new RegExp("\\"+fixerBox["char_"+i], 'g'); tempVar = tempVar.replace(pattern, fixerBox["spchar_"+i]); }; i++; }; if(i>120){ return tempVar;}; }; this.reCleanText = function ( tempVar ){ var i = 0 ; while(i<=120){ if(fixerBox["char_"+i]){ var pattern = new RegExp("\\"+fixerBox["spchar_"+i], 'g'); tempVar = tempVar.replace(pattern, fixerBox["char_"+i]); }; i++; }; if(i>120){ return tempVar;}; }; this.checkExpression = function ( tempVar, tempExp ){ var tempCheck = tempExp.test(tempVar); if( tempCheck ){ tempVar=true ; }; if( !tempCheck ){ tempVar = false ; }; return tempVar; }; this.clenseValue = function( tempVar){ tempVar= tempVar.toLowerCase(); tempVar = toolBox.cleanExpression( tempVar, fixerBox.checkSpace, "-"); return tempVar; }; this.sortArrayInt = function(temp1, temp2){ var i = 0; if (temp1 == temp2){return i;} if (temp1 < temp2){ return i--; } else{ return i++}; }; }; function buildHtml(){ this.buildAnchor = function( tempTest, tempTitle, option ){ var tempHtml = "<a href='" + tempTest + "' " + option + " >" + tempTitle + "</a>"; return tempHtml; }; this.buildButton = function( temp, tempNm, handClass ){ var tempHtml = "<input type='submit' name='" + tempNm + "' id='" + tempNm + "' value='" + temp + "' class='survey_button "+handClass+"' />"; return tempHtml;}; this.buildZoom = function( temp, tempNm, handClass ){ var tempHtml = "<input type='button' name='" + tempNm + "' id='" + tempNm + "' value='" + temp + "' class='zoom_button "+handClass+"' />"; return tempHtml; }; this.buildReturn = function( temp, tempNm){ var tempHtml = "<input type='submit' name='" + tempNm + "' id='" + tempNm + "' value='" + temp + "' class='survey_button survey-landing' />"; return tempHtml; }; this.buildElement = function( temp, elemType, option ){ var tempHtml = "<" + elemType + " " + option + " >" + temp + "</" + elemType + ">"; return tempHtml; }; this.buildIdElement = function( temp, elemType, tempId, option ){ var tempHtml = "<" + elemType + " id='" + tempId + "' " + option + " >" + temp + "</" + elemType + ">"; return tempHtml; }; this.buildHeadElement = function( temp, elemType, tempType, option ){ var tempHtml = "<" + elemType + " type='" + tempType + "' " + option + ">" + temp + "</" + elemType + ">"; return tempHtml; }; this.buildImage = function( tempSrc, tempAlt, option ){ var tempHtml = "<img src='" + tempSrc + "' title='" + tempAlt + "' alt='" + tempAlt + "' " + option + " />"; return tempHtml; }; this.buildInput = function( temp, tempNm, tempType, option ){ var tempHtml = "<input type='" + tempType +"' name='" + tempNm + "' value='" + temp + "' " + option + " />"; return tempHtml; }; this.buildInputId = function( temp, tempNm, tempId, tempType, option ){ var tempHtml = "<input type='" + tempType +"' name='" + tempNm + "' id='" + tempId + "' value='" + temp + "' " + option + " />"; return tempHtml; }; this.buildSelectId = function( temp, tempNm, tempId, option ){ var tempHtml = "<select id='"+tempId+"' name='"+tempNm+"' "+option+">"+temp+"</select>"; return tempHtml; }; this.buildOption = function( temp, tempClass){ var tempId; if(tempClass=="test_id"){ if(temp=="" || temp==undefined){tempId = "no_"+tempClass ; } else{ var objVal = toolBox.parseCustomSplit( temp, ":" ); tempId = $.trim(objVal[0]); tempId = $.trim(tempId).toLowerCase(); }; } else{ tempId = $.trim(temp).toLowerCase(); }; tempId = tempId+"_"+tempClass; tempId = toolBox.cleanExpression( tempId, fixerBox.checkSpace, "_"); tempId = toolBox.cleanExpression( tempId, /-/g, "_"); var tempHtml = "<option value='"+temp+"' class='option_"+tempClass+"' id='"+tempId+"'>"+temp+"</option>"; return tempHtml; }; this.buildInputArea = function( temp, tempNm, tempType, option ){ var tempHtml = "<"+tempType+" placeholder="+ tempNm +" name='" + tempNm + "' id='" + tempNm + "' " + option + " >" + temp + "</textarea>"; return tempHtml; }; this.buildCounter = function( temp, tempNm, tempLength, option ){ var tempHtml = "<input readonly='readonly' type='text' id='"+tempNm+"' name='"+ tempNm +"' size='"+tempLength+"' maxlength='"+tempLength+"' value='"+temp+"' " + option + "/> "; return tempHtml; }; this.buildAnswer = function( temp, tempNm, option ){ var tempHtml = "<input type='radio' id='"+temp+"' name='"+ tempNm +"' value='"+temp+"' " + option + "/>"; return tempHtml; }; this.survey_invalid_style ="box-shadow: -4px -4px 6px rgb(190,0,0);"; this.survey_valid_style ="box-shadow: -4px -4px 6px rgb(0,190,0);"; this.survey_warn_style = "border:0.3em double rgb(195, 0,0 );"; }; function _Admin(){ this.urlAdmin = function(){ this.fixer_1 = "_admin"; this.fixer_2 = "_Admin"; this.fixer_3 = "_ADMIN"; this.fixer_4 = "admin_"; this.fixer_5 = "Admin_"; this.fixer_6 = "ADMIN_"; this.fixer_7 = "-admin"; this.fixer_8 = "-Admin"; this.fixer_9 = "-ADMIN"; this.fixer_10 = "admin-"; this.fixer_11 = "Admin-"; this.fixer_12 = "ADMIN-"; this.fixer_13 = "admin"; this.fixer_14 = "Admin"; this.fixer_15 = "ADMIN"; return this; }; this.checkSet = function( openClass, editOption ){ var temp = htmlBox.buildIdElement( "", "div", "survey-setup", "style='visibility:hidden;'" ); $('#survey-content').append( temp ); if(openClass=="set_results"){ $(".title-box").empty().append("Saving...Please Wait."); var tempVal = []; var tempName = ""; $('input[type=radio]').each(function (){ var tempId = $(this).attr('id'); if( $(this).is(":checked") ){ var tempName = $(this).attr('name'); tempVal[tempName] = $(this).val(); system_opts["status_"+tempId] = "active"; } else{ system_opts["status_"+tempId] = "inactive"; }; }); var tempCheck = render.resetStyle( tempVal["surveyTheme"] ); var temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "defaults_set", "" , localConfig.domain1 , localConfig.filePathAdj, tempVal["surveyTheme"], tempVal["surveySetup"], tempVal["surveyFormat"], "title-box" ); }; }; if(openClass=="new_info_page"){ var tempWarn = ""; var tempReq ; var tempHTML = htmlBox.buildElement( "Checking Input...Please Wait.", "b", "class='green-alert'" ); $(".warn_message").empty().append(tempHTML); if( !newSurveyInfo.minutes || newSurveyInfo.minutes==undefined){ newSurveyInfo.minutes =0; }; if( !newSurveyInfo.seconds || newSurveyInfo.seconds==undefined ){ newSurveyInfo.seconds =0; }; if( newSurveyInfo.seconds <=9 && newSurveyInfo.seconds>0 ){ newSurveyInfo.seconds ="0"+newSurveyInfo.seconds; }; if( newSurveyInfo.seconds ==0 ){ newSurveyInfo.seconds ="00"; }; newSurveyInfo.timer = newSurveyInfo.minutes +":"+ newSurveyInfo.seconds ; var tempAll = ["status","form_type","user_level","timer","results","info_titles","page_name","survey_name","survey_title","author","release_date","overview","purpose","time_length","closing","closing_link","image_comment","info_image"]; if( newSurveyInfo.form_type=="Quiz" ){ tempReq = ["status","form_type","results","info_titles","page_name","survey_name","survey_title","overview","closing"]; } else{ tempReq = ["status","form_type","info_titles","page_name","survey_name","survey_title","overview","closing"]; }; $.each(tempAll, function(key,val){ if(newSurveyInfo[val] == val || newSurveyInfo[val].length < 1){ $.each(tempReq, function(key2,val2){ if( $.trim(val) == $.trim(val2) ){ if(val=="survey_name" && editOption!=""){ /*skip alert*/ } else{ $("#"+val2 ).addClass("input_checker_required"); var tempFix = val2.replace(/[\_\-]/g, fixerBox.cleanSpace); if( tempWarn != "" ){ tempWarn += ", ";}; tempWarn += tempFix.toUpperCase(); }; }; }); } else{ $("#"+val ).removeClass("input_checker_required"); }; }); if( tempWarn != ""){ tempHTML = htmlBox.buildElement( "Please Fix the following Inputs: "+tempWarn, "b", "class='red-alert'" ); $(".warn_message").empty().append(tempHTML); } else{ tempHTML = htmlBox.buildElement( "Input Passed Verification...Saving...Please Wait.", "b", "class='green-alert'" ); $(".warn_message").empty().append(tempHTML); var tempVal=""; if(editOption==""){ $.each(newSurveyInfo, function(key3, val3){ var tempCheck = toolBox.validateObject( "instruction", key3 ); if( tempCheck == false){ if(key3 != val3 && val3.length >= 1 && key3!="seconds" && key3!="minutes"){ tempVal += key3+"|=|"+ val3+"|_-_|"; }; }; }); var temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "new_info" , "", localConfig.domain1 , localConfig.filePathAdj, "", tempVal, "", "warn_message" ); }; }; if(editOption.length>0){ var intCheck = fixerBox.checkInteger.test( editOption ); if(intCheck == true){ newSurveyInfo.id = editOption ; newSurveyInfo.survey_name = editSurveyInfo.survey_name ; $.each(newSurveyInfo, function(key3, val3){ var tempCheck = toolBox.validateObject( "instruction", key3 ); if( tempCheck == false){ if(key3 != val3 && val3.length >= 1 && key3!="seconds" && key3!="minutes"){ tempVal += key3+"|=|"+ val3+"|_-_|"; }; editSurveyInfo[key3] = val3; }; }); var temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "edit_info" , "", localConfig.domain1 , localConfig.filePathAdj, "", tempVal, "", "warn_message" ); }; }; }; }; }; if(openClass=="new_question"){ var tempAnswer = ""; var tempWarn = ""; var tempHTML = htmlBox.buildElement( "Checking Input...Please Wait.", "b", "class='green-alert'" ); $(".warn_message").empty().append(tempHTML); var tempAll = ["test_id", "question", "comment", "image", "type", "status"]; var tempReq = ["test_id", "question", "type", "status"]; $.each(tempAll, function(key,val){ if(newSurvey[val] == val || newSurvey[val].length < 1){ $.each(tempReq, function(key2,val2){ if( $.trim(val) == $.trim(val2) ){ if(val=="test_id" && editOption!=""){ /*skip alert*/ } else{ $("#"+val2 ).addClass("input_checker_required"); var tempFix = val2.replace(/[\_\-]/g, fixerBox.cleanSpace); if( tempWarn != "" ){ tempWarn += ", ";}; tempWarn += tempFix.toUpperCase(); }; }; }); } else{ $("#"+val ).removeClass("input_checker_required"); }; }); if( localConfig.answer=="yes_answer"){ $(".new_answer").each(function(){ if($(this).is(":checked")){ $(this).attr("style", htmlBox.survey_valid_style); if(tempAnswer.length >1 ){ tempAnswer+="|=|"; }; var temp = $(this).val(); temp=temp.replace("answer_", ""); var tempVal =$("#choices_"+temp).val(); tempAnswer+=$.trim(tempVal); } else{ $(this).attr("style", "box-shadow: none;");}; }); }; if( localConfig.answer=="yes_answer" && tempAnswer.length<1){ if( tempWarn != "" ){ tempWarn += ", ";} tempWarn += "NO ANSWER SELECTED"; $(".new_answer").attr("style", htmlBox.survey_invalid_style); }; if( localConfig.answer=="no_answer" ){ $(".new_answer").attr("style","visibility:hidden;"); }; if( newSurvey.test_id=="test_id" && !($("#edit_name").attr("name")) ){ $(".new_answer").attr("style","visibility:hidden;"); }; if(newSurvey.choices_1=="choices_1"){ if( tempWarn != "" ){ tempWarn += ", ";} tempWarn += "INSUFFICENT CHOICES"; }; if( tempWarn != ""){ tempHTML = htmlBox.buildElement( "Please Fix the following Inputs: "+tempWarn, "b", "class='red-alert'" ); $(".warn_message").empty().append(tempHTML); } else{ tempHTML = htmlBox.buildElement( "Input Passed Verification...Saving...Please Wait.", "b", "class='green-alert'" ); $(".warn_message").empty().append(tempHTML); var tempVal=""; newSurvey["choices"]=""; newSurvey.answer = tempAnswer; if(editOption==""){ $.each(newSurvey, function(key3, val3){ if(val3.length>0){ var tempCheck = toolBox.validateObject( "instruction", key3 ); if( tempCheck == false){ var choiceCheck = toolBox.validateObject( "choices_", key3 ); if( choiceCheck == true){ if(newSurvey.choices.length >1 ){ newSurvey.choices+="|=|"; } newSurvey.choices+=val3 ; }; }; }; }); $.each(newSurvey, function(key3, val3){ if(key3!="undefined"){ if(val3.length>0){ tempCheck = toolBox.validateObject( "instruction", key3 ); if( tempCheck == false){ var choiceCheck = toolBox.validateObject( "choices_", key3 ); if( choiceCheck == false){ if( (key3 != val3 && val3 != "no_"+key3 ) && val3.length >= 1 ){ tempVal += key3+"|:|"+ val3+"|_-_|"; };}; }; }; }; }); var temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "new_question" , "", localConfig.domain1 , localConfig.filePathAdj, "", tempVal, "", "warn_message" ); }; }; if(editOption.length>0){ var intCheck = fixerBox.checkInteger.test( editOption ); if(intCheck == true){ newSurvey.id = editOption ; newSurvey.test_id =$("#edit_name").attr("name"); $.each(newSurvey, function(key3, val3){ if(val3.length>0){ var tempCheck = toolBox.validateObject( "instruction", key3 ); if( tempCheck == false){ var choiceCheck = toolBox.validateObject( "choices_", key3 ); if( choiceCheck == true){ if(newSurvey.choices.length >1 ){ newSurvey.choices+="|=|"; } newSurvey.choices+=val3; }; }; }; }); editSurvey["choices_"+editOption] = newSurvey.choices; $.each(newSurvey, function(key3, val3){ if(key3!="undefined"){ if(val3.length>0){ tempCheck = toolBox.validateObject( "instruction", key3 ); if( tempCheck == false){ var choiceCheck = toolBox.validateObject( "choices_", key3 ); if( choiceCheck == false){ if( (key3 != val3 && val3 != "no_"+key3 ) && val3.length >= 1 ){ tempVal += key3+"|:|"+ val3+"|_-_|"; }; }; }; }; }; }); var temp = connect.preloadConfig(); if (temp==1){ connect.setSurveyConfig( temp, "edit_question" , "", localConfig.domain1 , localConfig.filePathAdj, "", tempVal, "", "warn_message" ); }; }; }; newSurvey.choices=undefined ; newSurvey.answer=undefined ; }; }; }; this.createEdit = function( temp, tempNum ){ if(temp == "survey_edit"){ tempLaunch1==false; localConfig.compressed = ""; loader.adminSurveyEdit(); tempLaunch1 = controller.compress(); if( tempLaunch1==true ){ controller.decompress(); newSurveyInfo = new launch.surveyArchive(); newSurvey = new launch.questionArchive(); render.editing(); }; }; if(temp == "info_append"){ var tempVal; newSurveyInfo = new launch.surveyArchive(); var tempHTML = view.appendFormPages(editSurveyInfo); render.page( "info", tempHTML ); var tempTime = toolBox.parseCustomSplit( editSurveyInfo.timer, ":" ); var tempInfo = htmlBox.buildInputId( tempNum, "info_"+tempNum, "edit_number", "hidden", "" ); $(".info_box").append(tempInfo); editSurveyInfo.minutes = tempTime[0]; editSurveyInfo.seconds = tempTime[1]; var tempSec = toolBox.parseCustomSplit( editSurveyInfo.seconds, "" ); if(tempSec[0]=="00" || tempSec[0]==0){ editSurveyInfo.seconds=tempSec[1]; }; handlers.setButton("survey_edit_info"); var tempArray = ["status","form_type","user_level","user_name","minutes","seconds","results","info_titles"] ; $.each(tempArray, function (key,val){ if(editSurveyInfo[val] && editSurveyInfo[val]!= "NULL"){ tempVal = editSurveyInfo[val]; handlers.checkChoiceId( val, "selected", editSurveyInfo, tempVal, "" ); $("#"+ val).trigger('checker'); }; }); var tempArray2 = ["closing_link","page_name","survey_name","survey_title","author","release_date","overview","purpose","time_length","closing","image_comment","info_image"]; $.each(tempArray2, function(key2, val2){ if(editSurveyInfo[val2] && editSurveyInfo[val2]!= "NULL"){ var tempVal2 = toolBox.cleanExpression( editSurveyInfo[val2], fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $("#"+val2).val(tempVal2); $("#"+val2).trigger("click"); }; }); }; if(temp == "question_append"){ var i=0; var tempAnswer; newSurvey = new launch.questionArchive(); controller.testSetter(newSurvey, "question", "buildQuestionPages"); var stopIntervalComplete = setInterval( function(){ if(system_opts.set_complete==true){ var tempQuestion = htmlBox.buildInputId( tempNum, "question_"+tempNum, "edit_number", "hidden", "" ); tempQuestion += htmlBox.buildInputId( editSurveyInfo.survey_name, editSurveyInfo.survey_name, "edit_name", "hidden", "" ); $(".info_box").append(tempQuestion); $("#test_id_holder").remove(); $(".remove_test_id" ).empty().append("This is Question Id#"+tempNum+" of the "+editSurveyInfo.survey_title); var tempButton = htmlBox.buildButton( "Return to this Survey/Test Menu", "survey_edit", "survey_edit_info" ); $(".button_box").append(tempButton); handlers.setButton("survey_edit_info"); var tempTime = toolBox.parseDataSplit( editSurvey["choices_"+tempNum] ); var tempCheck = toolBox.validateObject( "|=|", editSurvey["answer_"+tempNum] ); var tempArray = [ "type", "status"]; $.each(tempArray, function (key,val){ tempVal = editSurvey[val+"_"+tempNum] ; handlers.checkChoiceId( val, "selected", editSurvey, tempVal, tempNum ); $("#"+ val).trigger('checker'); }); var tempArray2 = ["test_id", "question", "comment", "image" ] ; $.each(tempArray2, function(key2, val2){ if(editSurvey[val2+"_"+tempNum] && editSurvey[val2+"_"+tempNum]!= "NULL"){ if(val2=="status" || val2=="type"){ $("#"+toolBox.clenseValue(editSurvey[val2+"_"+tempNum])+"-"+val2).trigger("click"); } else if( val2=="test_id" ){/*skip*/} else{ var tempVal = toolBox.cleanExpression( editSurvey[val2+"_"+tempNum], fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $("#"+val2).val(tempVal); $("#"+val2).trigger("click"); }; }; }); if(tempCheck == true){ tempAnswer = toolBox.parseDataSplit( editSurvey["answer_"+tempNum] );}; $.each(tempTime, function(key1, val1){ i++; val1 = toolBox.cleanExpression( val1, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); var tempId = $("input#choices_"+i).attr("id"); if( tempId == undefined ){ var temp = view.buildChoices(i, editSurvey); $("#choices_holder").append(temp); if( editSurveyInfo.form_type == "Survey"){ $("#answer_"+i).attr("style", "visibility:hidden").attr("type", editSurvey["type_"+tempNum]); }; if( editSurveyInfo.form_type == "Quiz"){ $("#answer_"+i).attr("style", "visibility:visible").attr("type", editSurvey["type_"+tempNum]);}; var tempVal = "choices_"+i ; handlers.changeCounter( tempVal, 250, newSurvey ); handlers.cleanInputText( tempVal, "lit_string", newSurvey ); handlers.deleteChoice("delete_choice"); handlers.selectChoice( "new_answer", "checked", newSurvey ); handlers.multipleChoice( "new_answer", "checked", newSurvey ); $("input#choices_"+i).val(val1); if(tempCheck == true){ $.each(tempAnswer, function(key2, val2){ if($.trim(val1) == $.trim(val2) ){ $("#answer_"+i).attr('checked', true); document.getElementById( "answer_"+i ).checked=true; }; }); }; if(tempCheck == false){ if(val1 == editSurvey["answer_"+tempNum]){ $("#answer_"+i).attr('checked', true); document.getElementById( "answer_"+i ).checked=true; }; }; } else{ if( editSurveyInfo.form_type == "Survey"){ $("#answer_"+i).attr("style", "visibility:hidden").attr("type", editSurvey["type_"+tempNum]); }; if( editSurveyInfo.form_type == "Quiz"){ $("#answer_"+i).attr("style", "visibility:visible").attr("type", editSurvey["type_"+tempNum]);}; $("input#choices_"+i).val(val1); if(tempCheck == true){ $.each(tempAnswer, function(key2, val2){ if($.trim(val1) == $.trim(val2) ){ $("#answer_"+i).attr('checked', true); document.getElementById( "answer_"+i ).checked=true; }; }); }; if(tempCheck == false){ if(val1 == editSurvey["answer_"+tempNum]){ $("#answer_"+i).attr('checked', true); document.getElementById( "answer_"+i ).checked=true; }; }; }; }); clearInterval(stopIntervalComplete); }; }, 50); }; }; this.createNew = function( temp ){ newSurveyInfo = new launch.surveyArchive(); newSurvey = new launch.questionArchive(); editSurveyInfo = new launch.surveyArchive(); editSurvey = new launch.questionArchive(); if(temp == "survey_new_info"){ var tempHTML = view.buildFormPages(newSurveyInfo); render.page( "info", tempHTML ); }; if(temp == "survey_edit_info"){ controller.testSetter(newSurveyInfo, "survey_edit", "editFormPages"); }; if(temp == "survey_new_question"){ controller.testSetter(newSurvey, "question", "buildQuestionPages"); }; }; this.publisher = function( openClass, tempName, tempNum ){ editTestInfo=new Object; if(openClass=="publish_tracking"){ controller.publishSetter(editTestInfo, "tracking_info", "buildPublishPages", openClass); }; if(openClass=="publish_results"){ controller.publishSetter(editTestInfo, "result_info", "buildPublishPages", openClass); }; if(openClass=="publish_tracer" || openClass=="publish_tests"){ controller.fileSetter(tempNum, tempName, "buildFiles", openClass); }; }; this.downloader = function( openClass, tempName){ loader.adminDownloadCreate(openClass, tempName, openClass); }; }; function viewer( ){ this.newSurveyLanding = function( ){ var html = ""; var htmlTEMP = ""; var htmlTEXT = "Welcome to Surveyor Elite Content Management System"; var tempCheck = render.renderStyle(); html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); htmlTEMP = "Want to set the base color theme, if the information is in a closed 'accordion' or open, or if the survey take will be as a pop-up or in-page, click here:<br/>"; htmlTEMP += htmlBox.buildButton( "Set Defaults", "default-button", "survey_defaults" ); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "survey_defaults", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "survey_defaults", "class='choice_box'" ); htmlTEMP = "Want to create a new Test or Survey, click here:<br/>"; htmlTEMP += htmlBox.buildButton( "New Test or Survey Information", "survey_new_info", "default-button" ); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "survey_new_info", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "survey_new_info", "class='choice_box'" ); htmlTEMP = "Want to create a new Question to an existing Test or Survey, click here:<br/>"; htmlTEMP += htmlBox.buildButton( "Add Question to Survey or Test", "survey_new_question", "default-button" ); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "survey_new_question", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "survey_new_question", "class='choice_box'" ); htmlTEMP = "Want to edit an existing Survey or Test click here:<br/>"; htmlTEMP += htmlBox.buildButton( "Edit Survey or Test Information", "survey_edit_info", "default-button"); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "survey_edit_info", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "survey_edit_info", "class='choice_box'" ); htmlTEMP = "To Publish tracking, click here:<br/>"; htmlTEMP += htmlBox.buildButton( "Publish Tracking", "publish_tracking", "default-button" ); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "publish_tracking", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "publish_tracking", "class='choice_box'" ); htmlTEMP = "To Publish survey or test results, click here:<br/>"; htmlTEMP += htmlBox.buildButton( "Publish Results", "publish_results", "default-button" ); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "publish_results", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "publish_results", "class='choice_box'" ); tempCheck = render.renderLogo(); html = htmlBox.buildIdElement( html, "div", "set-surveyor", "class='info_box'" ); return html; }; this.newSurveyEditing = function( ){ var html = ""; var tempStyle = ""; var htmlTEMP = ""; var htmlTEMP_1 = ""; var htmlTEMP_2 = ""; var htmlTEXT = "You are now looking at: "+editSurveyInfo.survey_title; var tempCheck = render.renderStyle(); html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); htmlTEMP = htmlBox.buildElement( "Select a button to edit that content", "h2", "id='title-box'" ); htmlTEMP += htmlBox.buildButton( "Edit Information Page Settings: "+ editSurveyInfo.survey_title.toUpperCase() , "info_edit_"+editSurveyInfo.id , "info_append" ); htmlTEMP = htmlBox.buildIdElement( htmlTEMP, "p", "survey_defaults", " " ); html += htmlBox.buildIdElement( htmlTEMP, "div", "survey_defaults", "class='choice_box'" ); var i=0; $.each(editSurvey, function(key,val){ var choiceCheck1 = toolBox.validateObject( "question_", key ); var choiceCheck2 = toolBox.validateObject( "question_order", key ); var choiceCheck3 = toolBox.validateObject( "_instruction", key ); if( choiceCheck1 == true && choiceCheck2 == false && choiceCheck3 == false ){ i++; var tempNum = key.replace( "question_", "" ); var temVal = toolBox.cleanExpression( editSurvey["question_"+tempNum], fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); temVal = toolBox.cleanText( temVal ); if(editSurvey["status_"+tempNum] == "inactive"){ tempStyle = "set-inactive"; }; if( editSurvey["question_"+tempNum].length>103){ var tempTitle = temVal.substring(0, 100) +"..."; } else{ var tempTitle = temVal; }; var TEMP = htmlBox.buildButton( "Edit Question #"+ editSurvey["question_order_"+tempNum] + ": "+ tempTitle , "question_order_"+editSurvey["question_order_"+tempNum], "question_append "+key+" "+tempStyle ); htmlTEMP_2 += htmlBox.buildIdElement( TEMP, "p", "survey_edit_info-"+editSurvey["question_order_"+tempNum], " " ); tempStyle = ""; }; }); if(i>=1){ htmlTEXT = htmlBox.buildElement("Change Question Order:", "h2", "id='title-box'" ); htmlTEMP_1 += htmlBox.buildElement( htmlTEXT, "h3", "" ); htmlTEXT = editTestInfo.order_info+editTestInfo.hint_1+editTestInfo.hint_2+editTestInfo.hint_3+editTestInfo.note_1; htmlTEMP_1 += htmlBox.buildElement( htmlTEXT, "blockquote", "class='mini_survey_button'" ); var htmlTEMP_3 = "Question #"; htmlTEMP_3 += launch.buildEnum("order_A", i); htmlTEMP_3 += " "+fixerBox.spchar_55+" Move Behind #"; htmlTEMP_3 += launch.buildEnum("order_B", i); htmlTEMP_3 += htmlBox.buildButton( "Make Change", "change-button", "change_order" ); htmlTEMP_1 += htmlBox.buildElement( htmlTEMP_3, "blockquote", "class='score'" ); htmlTEXT = "NOTICE: Selected question will be marked in <span class='set-active' style='margin:0em;'>'green'</span>. Change-to question # will be marked in <span class='pre-active' style='margin:0em;'>'pink'</span>. Check before clicking 'Make Change' and permenantly changing.<br>"; htmlTEXT += htmlBox.buildButton( "&darr;", "survey_edit_info", "default-button")+editTestInfo.warn_1; htmlTEMP_1 += htmlBox.buildElement( htmlTEXT, "blockquote", "class='mini_survey_button'" ); htmlTEMP_1 += htmlBox.buildElement( "", "p", "class='warn_message'" ); }; if( htmlTEMP_1.length >0){ html += htmlBox.buildIdElement( htmlTEMP_1, "blockquote", "survey_edit_change", "class='accent-box'" ); }; if( htmlTEMP_2.length >0){ html += htmlBox.buildIdElement( htmlTEMP_2, "div", "survey_edit_info", "class='choice_box'" ); }; html += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); $("#survey-content").empty(); tempCheck = render.renderLogo(); html = htmlBox.buildIdElement( html, "div", "set-surveyor", "class='info_box'" ); return html; }; this.buildPublishPages = function( ObjTemp, tempArray, pageType){ var html= ""; var html2=""; var temp = ""; var tempTEXT=""; var tempVal=[]; if(pageType=="publish_tracking"){ tempVal= tempArray["users"]; var tagTTL = "Tracking"; var buttonTTL = "tracking_zip"; tempTEXT = "User Tracking Information Complete"; if(tempArray["total"]>0){ var tempTEXT2 = "Click &#8220;User Tracking&#8221; buttons to publish new information. &nbsp;Only users unpublished tracking shown. &nbsp;Each button represent up to 1000 files. &nbsp;If more than 1 button, it is recommended to publish in ascending order."; }; }; if(pageType=="publish_results"){ tempVal= tempArray["tests"]; var tagTTL = "Results"; var buttonTTL = "results_zip"; tempTEXT = "Specific Test or Survey Results"; if(tempVal!="error"){ var tempTEXT3 = "Click &#8220;Test Name&#8221; buttons to publish new information. &nbsp;Only Surveys or Test with unpublished results are shown. &nbsp;Each button represent up to 1000 files. &nbsp;If more than 1 button, it is recommended publish in ascending order."; }; }; var htmlTEXT = "Surveyor Elite Publish "+tempTEXT; html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); var tempHTML= "To Create Zip Archive from Published "+tagTTL+" Files, Click Here:"; buttonText = "Zip "+tagTTL+" XML"; tempHTML += htmlBox.buildButton(buttonText, buttonTTL, "file_download" ); html2 += htmlBox.buildElement( tempHTML, "blockquote", "" ); if(buttonTTL=="tracking_zip"){ buttonTTL = "tracking_download"; }; if(buttonTTL=="results_zip"){ buttonTTL = "results_download"; }; var tempHTML= "To Search for and Download Zipped "+tagTTL+" Archive, Click Here:"; buttonText = "Search For "+tagTTL+" Zip Folder"; tempHTML += htmlBox.buildButton(buttonText, buttonTTL, "file_download" ); html2 += htmlBox.buildElement( tempHTML, "blockquote", "" ); if(tempTEXT2){ tempTEXT2 = htmlBox.buildElement( tempTEXT2, "p", "" ); html += htmlBox.buildElement( tempTEXT2, "div", "class='splitter'" ); }; if(tempTEXT3){ html += htmlBox.buildElement( tempTEXT3, "p", "" ); }; if(pageType=="publish_tracking"){ var countSplit = 1000; if(tempArray["total"]!=undefined && tempArray["total"]>0){ var tempInt=parseInt(tempArray["total"]); if(tempInt<=countSplit){ var buttonNum = 1; buttonText = "User Tracking &nbsp;(1 - "+tempInt+") New"; var tempHTML = htmlBox.buildButton(buttonText, "user:"+buttonNum, "publish_tracer" ); html += htmlBox.buildElement( tempHTML, "blockquote", "" ); } else{var buttonNum = Math.ceil(tempInt/countSplit); var i=1; while(i<=buttonNum){ if( buttonNum==1 ){buttonText = "User Tracking &nbsp;(1 - "+tempInt+") New";}; if( tempInt>=(i*countSplit) ){ var tempNum2 = i*countSplit; var tempNum1 = (tempNum2-countSplit)+1; buttonText = "User Tracking &nbsp;("+tempNum1+" - "+tempNum2+") New";} else{ var tempNum2 = i*countSplit; var tempNum1 = (tempNum2-countSplit)+1; buttonText = "User Tracking &nbsp;("+tempNum1+" - "+tempInt+") New";}; var tempHTML = htmlBox.buildButton(buttonText, "user:"+i, "publish_tracer" ); html += htmlBox.buildElement( tempHTML, "blockquote", "" ); i++;}; }; }; }; if(pageType=="publish_results"){ var countSplit = 1000; var buttonText ; $.each(tempVal, function( key, val){ if(val!='' && val!=undefined){ var tempFix = toolBox.parseKeySplit(val); var tempInt=parseInt(tempFix[1]); if(tempInt<=countSplit){ var buttonNum = 1; buttonText = tempFix[0]+" &nbsp;(1 - "+tempFix[1]+") New"; var tempHTML = htmlBox.buildButton(buttonText, tempFix[0]+":"+buttonNum, "publish_tests" ); html += htmlBox.buildElement( tempHTML, "blockquote", "" ); } else{ var buttonNum = Math.ceil(tempInt/countSplit); var i=1; while(i<=buttonNum){ if( buttonNum==1 ){buttonText = tempFix[0]+" &nbsp;(1 - "+tempInt+") New";}; if( tempInt>=(i*countSplit) ){ var tempNum2 = i*countSplit; var tempNum1 = (tempNum2-countSplit)+1; buttonText = tempFix[0]+" &nbsp;("+tempNum1+" - "+tempNum2+") New";} else{ var tempNum2 = i*countSplit; var tempNum1 = (tempNum2-countSplit)+1; buttonText = tempFix[0]+" &nbsp;("+tempNum1+" - "+tempInt+") New";}; var tempHTML = htmlBox.buildButton(buttonText, tempFix[0]+":"+i, "publish_tests" ); html += htmlBox.buildElement( tempHTML, "blockquote", "" ); i++;}; }; }; }); }; html2 += htmlBox.buildElement( "", "p", "class='warn_message'" ); html2 += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); html += htmlBox.buildElement( html2, "div", "class='splitter'" ); return html; }; this.buildFiles = function( ObjTemp, tempArray, pageType){ var html= ""; var temp = ""; var tempTEXT=""; var tempVal=""; if(pageType=="publish_tracer"){ tempVal= tempArray["action"]; temp= tempArray["number"]; tempTEXT = "User Tracking Publisher"; }; if(pageType=="publish_tests"){ tempVal= tempArray["action"]; temp= tempArray["number"]; tempTEXT = "Specific Test or Survey Results Publisher"; }; var htmlTEXT = "Surveyor Elite "+tempTEXT; html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); var html2 = htmlBox.buildElement( "", "p", "class='warn_message'" ); html2 += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); html += htmlBox.buildElement( html2, "div", "class='splitter'" ); return html; }; this.buildDefaults = function( ){ var html = ""; var temp=""; var htmlTEMP = ""; var textTEMP = ""; var tempClass = ""; var tempTitle1 = false; var tempTitle2 = false ; var tempTitle3 = false ; var themeStyle_1 = "Classic Light"; var themeStyle_2 = "Contemporary Light"; var themeStyle_3 = "Classic Dark"; var themeStyle_4 = "Contemporary Dark"; var htmlTEXT = "Welcome to Surveyor Elite Website Default Settings"; var i = 1; html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); while( system_opts["id_"+i] ){ if(system_opts["default_name_"+i] == "surveyTheme"){ if( system_opts["id_"+i] <= 7 ){ system_opts["theme_type_"+i] = themeStyle_1; if(system_opts["default_value_"+i] == "None"){ textTEMP = system_opts["default_value_"+i]+" - Stucture Only Black Font"; } else{ textTEMP = system_opts["default_value_"+i]; }; } else if( system_opts["id_"+i] >= 8 && system_opts["id_"+i] <= 15 ){ system_opts["theme_type_"+i] = themeStyle_2; textTEMP = system_opts["default_value_"+i]; } else if( system_opts["id_"+i] >= 16 && system_opts["id_"+i] <= 23 ){ system_opts["theme_type_"+i] = themeStyle_3; if(system_opts["default_value_"+i] == "Inverse"){ textTEMP = system_opts["default_value_"+i]+" - Stucture Only White Font"; } else{ textTEMP = system_opts["default_value_"+i]; }; } else if( system_opts["id_"+i] >= 24 && system_opts["id_"+i] <= 30 ){ system_opts["theme_type_"+i] = themeStyle_4; textTEMP = system_opts["default_value_"+i]; } else{ /*skip*/ }; tempClass = "class='theme_choice set_survey'"; if(tempTitle1==false){ htmlTEXT = "1. Select the style theme:"; html += htmlBox.buildElement( htmlTEXT, "p", "class='title-box'" ); tempTitle1 = true; }; if(system_opts["status_"+i] == "active"){ temp = htmlBox.buildInputId(system_opts["default_value_"+i], system_opts["default_name_"+i] , i, "radio" , "checked='checked'"+tempClass ); } else{ temp = htmlBox.buildInputId(system_opts["default_value_"+i], system_opts["default_name_"+i] , i, "radio" , tempClass ); }; temp += "<label for='"+ i+"' >"+textTEMP+"</label>"; htmlTEMP += htmlBox.buildElement( temp, "span", "class='color_choice'" ); if( system_opts["id_"+i] == 7|| system_opts["id_"+i] == 15 || system_opts["id_"+i] == 23 || system_opts["id_"+i] == 30 ){ var tempHead = htmlBox.buildElement( system_opts["theme_type_"+i], "h4", "class='color_choice'" ); html += htmlBox.buildElement( tempHead + htmlTEMP, "blockquote", "class='choice_box'" ); htmlTEMP=""; }; } else{ if(system_opts["default_name_"+i] == "surveySetup"){ tempClass = "class='setup_choice set_survey'"; if(tempTitle2==false){ htmlTEXT = "2. Select how the survey or test information will initially appear. You are allowed up to 5 active surveys or tests per page. Single surveys should choose to display in the content area. If the page has other main content and 5 surveys are added, the accordion option could save display space:"; html += htmlBox.buildElement( htmlTEXT, "p", "class='title-box'" ); tempTitle2 = true; }; if(system_opts["default_value_"+i] == "url"){ textTEMP = "Survey information shown fully in the page content area."; }; if(system_opts["default_value_"+i] == "button"){ textTEMP = "Survey information collapsed in Jquery Accordion with Title as activation button."; }; }; if(system_opts["default_name_"+i] == "surveyFormat"){ tempClass = "class='format_choice set_survey'"; if(tempTitle3==false){ htmlTEXT = "3. Select how the survey or test will be taken:"; html += htmlBox.buildElement( htmlTEXT, "p", "class='title-box'" ); tempTitle3 = true; }; if(system_opts["default_value_"+i] == "in-page"){ textTEMP = "Survey taken in the page content area."; }; if(system_opts["default_value_"+i] == "pop-up"){ textTEMP = "Survey taken in a full screen pop-up, putting website in background. Page will be inaccessable while survey is being taken:"; }; }; if(system_opts["status_"+i] == "active"){ htmlTEMP = htmlBox.buildInputId(system_opts["default_value_"+i], system_opts["default_name_"+i] , i, "radio" , "checked='checked'"+tempClass ); } else{ htmlTEMP = htmlBox.buildInputId(system_opts["default_value_"+i], system_opts["default_name_"+i] , i, "radio" , tempClass ); }; htmlTEMP += htmlBox.buildElement( textTEMP, "span", "" ); html += htmlBox.buildElement( htmlTEMP, "p", "class='choice_box'" ); }; i++; }; html += htmlBox.buildButton( "Set Defaults", "set-button", "set_results" ); html += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); return html ; }; this.buildFormPages = function( ObjTemp){ var html= ""; var temp = ""; var htmlTEXT = "Surveyor Elite New Survey or Quiz Information Page and Settings"; html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); html += htmlBox.buildElement( "", "p", "class='warn_message'" ); $.each(ObjTemp, function( key, val){ var tempCheck = toolBox.validateObject( "instruction", key ); if( tempCheck == false){ if(key != "id"){ html += htmlBox.buildElement( ObjTemp[ key+"_instruction" ], "p", "class='remove_"+key+" instruct_box'" ); var tempArray1 = ["form_type","user_level","status","info_titles","results","user_name"]; var tempArray2 = ["timer"]; var tempArray3 = ["overview","time_length","purpose","closing"]; var tempArray4 = ["survey_title","author","release_date","image_comment"]; var tempVal1 = jQuery.inArray(key, tempArray1); var tempVal2 = jQuery.inArray(key, tempArray2); var tempVal3 = jQuery.inArray(key, tempArray3); var tempVal4 = jQuery.inArray(key, tempArray4); if( tempVal1 >=0 ){ temp += launch.buildEnum( key, ""); } else if( tempVal2 >=0 ){ temp += launch.buildEnum( key, "minutes" ); temp += " : "; temp += launch.buildEnum( key, "seconds" ); } else if( tempVal3 >=0 ){ if(key==val){var tempVal = "";}else{ var tempVal = val; }; temp += htmlBox.buildInputArea( "", val, "textarea", "class='new_info'" ); temp += htmlBox.buildCounter( "", key+"_counter", 3, "" ); } else if( tempVal4 >=0 ){ if(key==val){var tempVal = "";}else{ var tempVal = val; }; temp += htmlBox.buildInputId( "", val, val, "text", "class='new_info'" ); temp += htmlBox.buildCounter( "", key+"_counter", 3, "" ); } else{ temp += htmlBox.buildInputId( "", val, val, "text", "class='new_info'" ); temp += htmlBox.buildElement( "", "blockquote", "class='"+key+"_checker red-alert small_box'" ); }; html += htmlBox.buildElement( temp, "p", "class='choice_box' id='"+key+"_holder'" ); temp=""; }; }; }); html += htmlBox.buildElement( "", "p", "class='warn_message'" ); html += htmlBox.buildButton( "Set Information", "set-button", "new_info_page" ); html += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); if(ObjTemp.warn0_instruction) { html += htmlBox.buildElement( ObjTemp.warn0_instruction, "blockquote", "class='red-alert small_box'" ); }; if(ObjTemp.warn1_instruction) { html += htmlBox.buildElement( ObjTemp.warn1_instruction, "blockquote", "class='red-alert small_box'" ); }; if(ObjTemp.warn2_instruction) { html += htmlBox.buildElement( ObjTemp.warn2_instruction, "blockquote", "class='red-alert small_box'" ); }; return html; }; this.appendFormPages = function( ObjTemp){ var html= ""; var temp = ""; var htmlTEXT = "Surveyor Elite Edit Survey or Quiz Information Page and Settings"; html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); html += htmlBox.buildElement( "", "p", "class='warn_message'" ); $.each(ObjTemp, function( key, val){ if(val=="NULL"){ val=key; }; var tempCheck = toolBox.validateObject( "instruction", key ); if( tempCheck == false){ if(key != "id" && key!="survey_name" && key != "minutes" && key != "seconds"){ val = toolBox.cleanExpression( val, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); var tempArray1 = ["form_type","user_level","status","info_titles","results","user_name"]; var tempArray2 = ["timer"]; var tempArray3 = ["overview","time_length","purpose","closing"]; var tempArray4 = ["survey_title","author","release_date","image_comment"]; var tempVal1 = jQuery.inArray(key, tempArray1); var tempVal2 = jQuery.inArray(key, tempArray2); var tempVal3 = jQuery.inArray(key, tempArray3); var tempVal4 = jQuery.inArray(key, tempArray4); html += htmlBox.buildElement( ObjTemp[ key+"_instruction" ], "p", "class='instruct_box'" ); if( tempVal1 >=0 ){ temp += launch.buildEnum( key, ""); } else if( tempVal2 >=0 ){ temp += launch.buildEnum( key, "minutes" ); temp += " : "; temp += launch.buildEnum( key, "seconds" ); } else if( tempVal3 >=0 ){ if(key==val){var tempVal = "";}else{ var tempVal = val; }; temp += htmlBox.buildInputArea( tempVal, key, "textarea", "class='new_info'" ); temp += htmlBox.buildCounter( "", key+"_counter", 3, "" ); } else if( tempVal4 >=0 ){ if(key==val){var tempVal = "";}else{ var tempVal = val; }; temp += htmlBox.buildInputId( tempVal, key, key, "text", "class='new_info'" ); temp += htmlBox.buildCounter( "", key+"_counter", 3, "" ); } else{ if(key==val){var tempVal = "";}else{ var tempVal = val; }; temp += htmlBox.buildInputId( tempVal, key, key, "text", "class='new_info'" ); temp += htmlBox.buildElement( "", "blockquote", "class='"+key+"_checker red-alert small_box'" ); }; html += htmlBox.buildElement( temp, "p", "class='choice_box'" ); temp=""; }; }; }); html += htmlBox.buildElement( "", "p", "class='warn_message'" ); html += htmlBox.buildButton( "Submit Edits", "set-button", "new_info_page" ); html += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); html += htmlBox.buildButton( "Return to this Survey/Test Menu", "survey_edit", "survey_edit_info" ); if(ObjTemp.warn0_instruction) { html += htmlBox.buildElement( ObjTemp.warn0_instruction, "blockquote", "class='red-alert small_box'" ); }; if(ObjTemp.warn1_instruction) { html += htmlBox.buildElement( ObjTemp.warn1_instruction, "blockquote", "class='red-alert small_box'" ); }; if(ObjTemp.warn2_instruction) { html += htmlBox.buildElement( ObjTemp.warn2_instruction, "blockquote", "class='red-alert small_box'" ); }; return html; }; this.editFormPages = function( ObjTemp, tempArray){ var html= ""; var temp = ""; var htmlTEXT = "Surveyor Elite Edit Survey or Quiz Information Page and Settings"; html += htmlBox.buildElement( htmlTEXT, "h1", "id='survey_page_count'" ); $.each(ObjTemp, function( key, val){ var tempCheck = toolBox.validateObject( "instruction", key ); if( tempCheck == false){ if( key =="survey_name" && ObjTemp[key]==key){ temp += launch.buildEnum( key, tempArray); }; html += htmlBox.buildElement( temp, "p", "class='choice_box'" ); temp=""; }; }); html += htmlBox.buildElement( "", "p", "class='warn_message'" ); html += htmlBox.buildButton( "Edit Selection", "survey_edit", "survey_edit_info" ); html += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); return html; }; this.buildChoices = function( tempNum , ObjTemp ){ var tempChoice="";var temp = ""; if(!ObjTemp["choices_"+tempNum]){ObjTemp["choices_"+tempNum]="choices_"+tempNum;}; var key = "choices_"+tempNum; var key2 = "answer_"+tempNum; var key3 = "answer"; var key4 = "delete_"+tempNum ; tempChoice += htmlBox.buildAnswer( key2, key3, "class='new_answer' style='visibility:hidden;' " ); tempChoice += htmlBox.buildInputId( "", key, key, "text", "class='new_info new_choice'" ); tempChoice += htmlBox.buildCounter( "250", key+"_counter", 3, "" ); var tempIcon = render.renderIconDelete(); tempChoice += htmlBox.buildIdElement( tempIcon, "span", "delete_"+tempNum,"class='delete_choice'" ); temp += htmlBox.buildElement( tempChoice , "span", "class='"+key+" append_choice'" ); tempChoice = ""; return temp; }; this.buildQuestionPages = function( ObjTemp, tempArray ){ var html= ""; var temp = ""; var tempNum=2; if($(".question-builder").length<1){ var htmlTEXT = "Surveyor Elite New Survey or Quiz Question & Answer Builder"; html += htmlBox.buildElement( htmlTEXT, "h1", " class='question-builder' id='survey_page_count'" ); }; html += htmlBox.buildElement( "", "p", "class='warn_message'" ); $.each(ObjTemp, function( key, val){ var tempCheck = toolBox.validateObject( "instruction", key ); if( tempCheck == false){ if(key != "id" && key != "answer" && key != "question_order" ){ var choiceCheck = toolBox.validateObject( "choices", key ); if( choiceCheck == true){ var tempKey = key.replace("choices_", ""); if(tempKey == 1){ tempKey = htmlBox.buildInputId( "Add another choice block", "new_choice", "new_choice", "button", "class='mini_survey_button'" ); html += htmlBox.buildElement( ObjTemp[ "choices_instruction" ]+tempKey, "p", "class='remove_choices instruct_box'" ); }; }; if( choiceCheck == false){ html += htmlBox.buildElement( ObjTemp[ key+"_instruction" ], "p", "class='remove_"+key+" instruct_box'" ); }; if( key =="status" || key =="type" ){ temp += launch.buildEnum( key, ""); } else if( key =="question" ){ temp += htmlBox.buildInputArea( "", val, "textarea", "class='new_info'" ); temp += htmlBox.buildCounter( "", key+"_counter", 3, "" ); } else if( choiceCheck ==true ){ var i=1; var tempChoice = ""; while(i<=tempNum){ if(!ObjTemp["choices_"+i]){ObjTemp["choices_"+i]="choices_"+i;} key = "choices_"+i; var key2 = "answer_"+i; var key3 = "answer"; var key4 = "delete_"+i; tempChoice = htmlBox.buildAnswer( key2, key3, "class='new_answer' style='visibility:hidden;' " ); tempChoice += htmlBox.buildInputId( "", key, key, "text", "class='new_info new_choice'" ); tempChoice += htmlBox.buildCounter( "", key+"_counter", 3, "" ); var tempIcon = render.renderIconDelete(); tempChoice += htmlBox.buildIdElement( tempIcon, "span", "delete_"+i,"class='delete_choice'" ); temp += htmlBox.buildElement( tempChoice , "span", "class='"+key+" append_choice'" ); i++;tempChoice = ""; }; } else if( key =="comment" ){ temp += htmlBox.buildInputId( "", val, val, "text", "class='new_info'" ); temp += htmlBox.buildCounter( "", key+"_counter", 3, "" ); } else if( key =="test_id" ){ temp += launch.buildEnum( key, tempArray); } else{ temp += htmlBox.buildInputId( "", val, val, "text", "class='new_info'" ); temp += htmlBox.buildElement( "", "blockquote", "class='"+key+"_checker red-alert small_box'" ); }; choiceCheck = toolBox.validateObject( "choices", key ); if(choiceCheck == true){key = "choices";} html += htmlBox.buildIdElement( temp, "p", key+"_holder", "class='choice_box'" ); temp=""; }; }; }); html += htmlBox.buildElement( "", "p", "class='warn_message'" ); var tempHTML = htmlBox.buildButton( "Set Information", "set-button", "new_question" ); tempHTML += htmlBox.buildButton( "Return to CMS Menu", "default-button", "landing" ); html += htmlBox.buildElement( tempHTML, "p", "class='button_box'" ); if(ObjTemp.warn0_instruction) { html += htmlBox.buildElement( ObjTemp.warn0_instruction, "blockquote", "class='red-alert small_box'" ); }; if(ObjTemp.warn1_instruction) { html += htmlBox.buildElement( ObjTemp.warn1_instruction, "blockquote", "class='red-alert small_box'" ); }; if(ObjTemp.warn2_instruction) { html += htmlBox.buildElement( ObjTemp.warn2_instruction, "blockquote", "class='red-alert small_box'" ); }; return html; }; }; function _render(){ this.landing = function(){ var stopIntervalComplete = setInterval( function(){ if(system_opts.set_complete==true){ var html = view.newSurveyLanding(); $("#survey-content").append(html); handlers.setSurveyDefaults("survey_defaults"); handlers.newButton("survey_new_info"); handlers.newButton("survey_new_question"); handlers.newButton("survey_edit_info"); handlers.publish("publish_tracking"); handlers.publish("publish_results"); clearInterval(stopIntervalComplete);}; }, 10); }; this.editing = function(){ var stopIntervalComplete = setInterval( function(){ if(system_opts.set_complete==true){ var html = view.newSurveyEditing(); $("#survey-content").append(html); handlers.editAppend("info_append"); handlers.editAppend("question_append"); handlers.newButton("survey_edit_info"); handlers.selectChoiceId( "order_A", "selected", editSurvey ); handlers.selectChoiceId( "order_B", "selected", editSurvey ); handlers.orderButton("change-button"); handlers.landing("landing"); clearInterval(stopIntervalComplete);}; }, 10); }; this.page = function( name, html ){ if( name == "defaults"){ html = view.buildDefaults(); $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); handlers.viewStyle("theme_choice"); handlers.selectChoice("setup_choice", "checked", system_opts ); handlers.selectChoice("format_choice", "checked", system_opts ); handlers.setResults("set_results", ""); handlers.landing("landing"); }; if( name == "info"){ $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); var tempArray = ["status","form_type","user_level","minutes","seconds","results","info_titles","user_name"]; $.each(tempArray, function(key,val){ handlers.selectChoiceId( val, "selected", newSurveyInfo ); }); var tempArray = ["page_name","survey_name"]; $.each(tempArray, function(key,val){ handlers.cleanInputText( val, "data_name", newSurveyInfo ); }); var tempArray = ["survey_title","author","release_date","overview","purpose","time_length","closing","image_comment"]; var tempCounter = [200,200,100,500,500,500,500,200,200] ; $.each(tempArray, function(key,val){ handlers.changeCounter( val, tempCounter[key], newSurveyInfo ); }); handlers.CheckInput( "closing_link", fixerBox.checkUrl, newSurveyInfo ); handlers.CheckInput( "info_image", fixerBox.checkUrl, newSurveyInfo ); var tempArray = ["closing_link","page_name","survey_name","survey_title","author","release_date","overview","purpose","time_length","closing","image_comment","info_image"]; handlers.setResults("new_info_page",tempArray); handlers.landing("landing"); }; if( name == "survey_edit"){ $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); var tempArray = ["survey_name"] ; $.each(tempArray, function(key,val){ handlers.selectChoiceId( val, "selected", editSurveyInfo ); handlers.answerOptionId( val ); }); handlers.setButtonId("survey_edit_info"); handlers.landing("landing"); }; if( name == "question"){ $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); var tempArray = ["status","test_id","type"] ; $.each(tempArray, function(key,val){ handlers.selectChoiceId( val, "selected", newSurvey ); handlers.answerOptionId( val ); }); handlers.selectChoiceId( "new_answer", "checked", newSurvey ); handlers.multipleChoice( "new_answer", "checked", newSurvey ); var tempArray = ["question","choices_1","choices_2","comment"] ; var tempCounter = [500,250,250,250] ; $.each(tempArray, function(key,val){ handlers.changeCounter( val, tempCounter[key], newSurvey ); }); handlers.addChoice("new_choice", newSurvey ); handlers.deleteChoice("delete_choice" ); handlers.CheckInput( "image", fixerBox.checkUrl, newSurvey ); var tempArray = ["test_id", "question", "choices", "answer", "comment", "image", "type", "status"]; handlers.deleteChoice("new_question"); handlers.setResultsId("new_question",tempArray); handlers.landing("landing"); }; if( name == "result_info"){ $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); handlers.publisher("publish_tests"); handlers.downloader("file_download"); handlers.landing("landing"); }; if( name == "tracking_info"){ $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); handlers.publisher("publish_tracer"); handlers.downloader("file_download"); handlers.landing("landing"); }; if( name == "publish_tests" || name == "publish_tracer" ){ $(".info_box").empty().append(html); $("#set-surveyor").attr("class", name+"_page info_box" ); handlers.landing("landing"); }; }; this.resetStyle = function( temp ){ var i=1; while(system_opts["default_object_"+i] ){ if( system_opts["status_"+i] =="active" && system_opts["default_name_"+i] =="surveyTheme" ){ system_opts["status_"+i] ="inactive"; }; if( system_opts["default_value_"+i] == temp ){ system_opts["status_"+i] = "active"; system_opts.surveyCSS = system_opts["default_object_"+i] ; var html = htmlBox.buildHeadElement( system_opts.surveyCSS, "style", "text/css", "class='survey_head'" ); $("head").append(html); } i++ } return true; }; this.renderStyle = function(){ var i=1; while(system_opts["default_object_"+i] ){ if( system_opts["status_"+i] =="active"){ if( system_opts["default_object_"+i] !="NULL" ){ if( $(".survey_head") ){$(".survey_head").remove(); }; system_opts.surveyCSS = system_opts["default_object_"+i]; var html = htmlBox.buildHeadElement( system_opts.surveyCSS, "style", "text/css", "class='survey_head'" ); $("head").append(html); }; };i++ }; return true; }; this.markInput = function( temp, tempSet, tempclear ){ $(".question_append").removeClass(tempSet+"-active"); $("#question_order_"+temp).removeClass("survey_button").removeClass(tempclear+"-active").addClass(tempSet+"-active"); $.each( $(".question_append"), function(){ var tempId = $(this).attr("id"); var tempClasses = $(this).attr("class"); var tempCheck1 = toolBox.validateObject(tempSet+"-active", tempClasses); var tempCheck2 = toolBox.validateObject(tempclear+"-active", tempClasses); var tempCheck3 = toolBox.validateObject("survey_button", tempClasses); if(tempCheck1==false && tempCheck2 ==false && tempCheck3 ==false){ $("#"+tempId).addClass("survey_button"); }; }); return true; }; this.changeStyle = function( temp ){ if( $(".survey_head") ){$(".survey_head").remove(); }; var html = htmlBox.buildHeadElement( system_opts["default_object_"+temp], "style", "text/css", "class='survey_head'" ); $("head").append(html); return true; }; this.renderLogo = function(){ var htmlLogo = htmlBox.buildImage( "http://"+ localConfig.domain1 + localConfig.filePathAdj + "/Surveyor-Elite/_library/surveyorelite.png", "Surveyor Elite Logo", "class='survey_logo'" ); var htmlZoom = htmlBox.buildZoom( "-", "-", "zoom_out" ); htmlZoom += htmlBox.buildElement( "Zoom Text", "b", "" ); htmlZoom += htmlBox.buildZoom( "+", "+", "zoom_in" ); htmlZoom = htmlBox.buildElement( htmlZoom, "span", "id='survey_page_count'" ); htmlLogo = htmlBox.buildElement( htmlZoom + htmlLogo, "div", "style='width:100%;overflow:hidden;'" ); $("#survey-content").append(htmlLogo); handlers.zoomText( "zoom_in" ); handlers.zoomText( "zoom_out" ); return true; }; this.renderIconOpen = function(){ var htmlImg = htmlBox.buildImage( "http://"+ localConfig.domain1 + localConfig.filePathAdj + "/Surveyor-Elite/_library/open.png", "Open", "class='open_closed'" ); return htmlImg ; }; this.renderIconClose = function(){ var htmlImg = htmlBox.buildImage( "http://"+ localConfig.domain1 + localConfig.filePathAdj + "/Surveyor-Elite/_library/closed.png", "Close", "class='open_closed'" ); return htmlImg ; }; this.renderIconDelete = function(){ var htmlImg = htmlBox.buildImage( "http://"+ localConfig.domain1 + localConfig.filePathAdj + "/Surveyor-Elite/_library/delete.png", "Delete this selection", "class='delete_icon'" ); return htmlImg ; }; }; function _handlers(){ this.changeCounter = function( openClass, tempCount, ObjTemp){ $( '#'+openClass+"_counter" ).val( tempCount ); $( '#'+openClass ).on( 'keyup', function(){ var valId = $(this).attr('id'); var setObj = ""; if( ObjTemp[valId] == newSurveyInfo[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[valId] == newSurvey[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurvey"; }; var valAnswer = $(this).val(); var choiceCheck = toolBox.validateObject( "choices", valId ); var tempArray = ["question","image_comment","comment","overview","survey_title","purpose","time_length","closing","author","release_date"]; valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkSpacePlus, fixerBox.cleanSpacePlus); if(choiceCheck == true){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkLiteralString , fixerBox.cleanLiteralString ); ObjTemp[valId] = valAnswer; }; $.each(tempArray, function(key,val){ if(openClass == val){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkLiteralString , fixerBox.cleanLiteralString ); ObjTemp[valId] = valAnswer; }; }); if( setObj == "newSurveyInfo" ){ newSurveyInfo[valId] = ObjTemp[valId]; }; if( setObj == "newSurvey" ){ newSurvey[valId] = ObjTemp[valId] ; }; var valCount = valAnswer.length; if(valCount<=tempCount){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $( '#'+openClass+"_counter" ).val(tempCount-valCount); $( '#'+openClass ).val( valAnswer ); } else{ valAnswer = valAnswer.substring(0, tempCount); valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $( '#'+openClass ).val( valAnswer );}; if( setObj == "newSurveyInfo"){ newSurveyInfo[valId] = ObjTemp[valId]; }; if( setObj == "newSurvey" ){ newSurvey[valId] = ObjTemp[valId]; }; }).bind( 'click', function(){ var valId = $(this).attr('id'); var setObj = ""; if( ObjTemp[valId] == newSurveyInfo[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[valId] == newSurvey[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurvey"; }; var valAnswer = $(this).val(); var choiceCheck = toolBox.validateObject( "choices", valId ); var tempArray = ["question","image_comment","comment","overview","survey_title","purpose","time_length","closing","author","release_date"]; valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkSpacePlus, fixerBox.cleanSpacePlus); if(choiceCheck == true){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkLiteralString , fixerBox.cleanLiteralString ); ObjTemp[valId] = valAnswer; }; $.each(tempArray, function(key,val){ if(openClass == val){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkLiteralString , fixerBox.cleanLiteralString ); ObjTemp[valId] = valAnswer;}; }); if( setObj == "newSurveyInfo" ){ newSurveyInfo[valId] = ObjTemp[valId]; }; if( setObj == "newSurvey" ){ newSurvey[valId] = ObjTemp[valId]; }; var valCount = valAnswer.length; if(valCount<=tempCount){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $( '#'+openClass+"_counter" ).val(tempCount-valCount); $( '#'+openClass ).val( valAnswer ); } else{ valAnswer = valAnswer.substring(0, tempCount); valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.recheckLiteralString , fixerBox.recleanLiteralString ); $( '#'+openClass ).val( valAnswer );}; if( setObj == "newSurveyInfo"){ newSurveyInfo[valId] = ObjTemp[valId]; }; if( setObj == "newSurvey" ){ newSurvey[valId] = ObjTemp[valId]; }; }); }; this.cleanInputText = function( openClass, cleanType, ObjTemp ){ $( '#'+openClass ).on( 'keyup', function(){ var valId = $(this).attr('id'); var setObj = ""; if( ObjTemp[valId] == newSurveyInfo[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[valId] == newSurvey[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurvey"; }; var valAnswer = $(this).val(); valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkSpacePlus, fixerBox.cleanSpacePlus); if(cleanType == "data_name"){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkDataName , "" ); ObjTemp[valId] = valAnswer; $( '#'+openClass ).val(valAnswer ); }; if( setObj == "newSurveyInfo" ){ newSurveyInfo[valId] = ObjTemp[valId]; }; if( setObj == "newSurvey" ){ newSurvey[valId] = ObjTemp[valId]; }; $( '#'+openClass ).val( valAnswer); }).bind( 'click', function(){ var valId = $(this).attr('id'); var setObj = ""; if( ObjTemp[valId] == newSurveyInfo[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[valId] == newSurvey[valId] && ObjTemp[valId] != undefined ){ setObj = "newSurvey"; }; var valAnswer = $(this).val(); valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkSpacePlus, fixerBox.cleanSpacePlus); if(cleanType == "data_name"){ valAnswer = toolBox.cleanExpression( valAnswer, fixerBox.checkDataName , "" ); ObjTemp[valId] = valAnswer; $( '#'+openClass ).val(valAnswer ); }; if( setObj == "newSurveyInfo" ){ newSurveyInfo[valId] = ObjTemp[valId] }; if( setObj == "newSurvey" ){ newSurvey[valId] = ObjTemp[valId]; }; $( '#'+openClass ).val( valAnswer); }); }; this.CheckInput = function( openClass, tempExpr, ObjTemp ){ $( '#'+openClass ).on( 'keyup', function(){ var valAnswer = $.trim( $(this).val() ); var setObj = ""; if( ObjTemp[openClass] == newSurveyInfo[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[openClass] == newSurvey[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurvey"; }; var valCheck = toolBox.checkExpression( valAnswer, tempExpr ); if(valCheck == false){ $( '.'+openClass+"_checker" ).empty().append("Input not yet valid. Continue to type or edit.").removeClass("green-alert").addClass("red-alert"); }; if(valCheck == true ){ ObjTemp[openClass]=valAnswer; ObjTemp[openClass] = toolBox.cleanExpression( valAnswer, fixerBox.checkLiteralString , fixerBox.cleanLiteralString ); $( '.'+openClass+"_checker" ).empty().append("Input valid.").removeClass("red-alert").addClass("green-alert"); }; if( setObj == "newSurveyInfo" ){ newSurveyInfo[openClass] = ObjTemp[openClass]; }; if( setObj == "newSurvey" ){ newSurvey[openClass] = ObjTemp[openClass]; }; }).bind( 'click', function(){ var valAnswer = $.trim( $(this).val() ); var setObj = ""; if( ObjTemp[openClass] == newSurveyInfo[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[openClass] == newSurvey[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurvey"; }; var valCheck = toolBox.checkExpression( valAnswer, tempExpr ); if(valCheck == false){ $( '.'+openClass+"_checker" ).empty().append("Input not yet valid. Continue to type or edit.").removeClass("green-alert").addClass("red-alert"); }; if(valCheck == true ){ ObjTemp[openClass]=valAnswer; ObjTemp[openClass] = toolBox.cleanExpression( valAnswer, fixerBox.checkLiteralString , fixerBox.cleanLiteralString ); $( '.'+openClass+"_checker" ).empty().append("Input valid.").removeClass("red-alert").addClass("green-alert"); }; if( setObj == "newSurveyInfo" ){ newSurveyInfo[openClass] = ObjTemp[openClass] ; }; if( setObj == "newSurvey" ){ newSurvey[openClass] = ObjTemp[openClass] ; }; }); }; this.zoomText = function( openClass ){ user.zoomer=1; $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); if(valId=="+"){ user.zoomer=user.zoomer + 0.5; if( user.zoomer>=4){user.zoomer=4; };}; if(valId=="-"){ user.zoomer=user.zoomer - 0.5; if( user.zoomer<=1){user.zoomer=1; };}; $("#wrap-pop").removeAttr("style").attr("style", "font-size:"+user.zoomer+"em;"); $("#survey-content").removeAttr("style").attr("style", "font-size:"+user.zoomer+"em;"); }).bind( 'select', function(){ var valId = $(this).attr('id'); if(valId=="+"){ user.zoomer=user.zoomer + 0.5; if( user.zoomer>=4){user.zoomer=4; };}; if(valId=="-"){ user.zoomer=user.zoomer - 0.5; if( user.zoomer<=1){user.zoomer=1; };}; $("#wrap-pop").removeAttr("style").attr("style", "font-size:"+user.zoomer+"em;"); $("#survey-content").removeAttr("style").attr("style", "font-size:"+user.zoomer+"em;"); }); }; this.viewStyle = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); var valAnswer = $(this).val(); var tempCheck = render.changeStyle(valId); $("."+openClass).attr('checked', false); $("#"+valId).attr('checked', true); document.getElementById( valId ).checked=true; }); }; this.checkChoiceId = function( openClass, choiceClass, ObjTemp, checkVal, tempNum ){ $( '#'+openClass ).on( 'checker', function(){ var valId=''; var valType = ""; var idClass = ""; var tempId = ""; var tempClass = ""; var valAnswer=""; var tempClass = ""; var classId = ""; var tempCheck1 = ""; var tempCheck2 = ""; var objId ; valAnswer = $(this).val(); if(valAnswer=="" || openClass=="minutes" || openClass=="seconds"){ valAnswer = checkVal; }; var setObj = ""; if( ObjTemp[openClass] == newSurveyInfo[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp[openClass] == newSurvey[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurvey"; }; if( ObjTemp[openClass] == editSurveyInfo[openClass] && ObjTemp[openClass] != undefined ){ setObj = "newSurveyInfo"; }; if( ObjTemp == editSurvey && ObjTemp[openClass+"_"+ tempNum ] != undefined ){ setObj = "editSurvey";}; if(valAnswer!= ""){ idClass = "option_"+openClass ; $.each($("."+idClass), function(){ var tempVal = $(this).val(); if(valAnswer==tempVal){ valId = $(this).attr('id'); tempClass = $(this).attr('class'); $("#"+valId).attr( choiceClass, true); } else{ $(this).attr( choiceClass, false); }; }); tempCheck1 = toolBox.validateObject( "option_test_id", tempClass ); tempCheck2 = toolBox.validateObject( "option_survey_name", tempClass ); if(tempCheck1==true || tempCheck2==true){ objId = toolBox.parseCustomSplit( valAnswer, ":" ); if(tempCheck1==true && tempCheck2==false){ var idName = "test_id"; }; if(tempCheck2==false && tempCheck2==true){ var idName = "survey_name"; }; valAnswer=$.trim(objId[1]); valType=$.trim(objId[0]); objId[1]=undefined; } else{ var idName = $(this).attr('name'); objId = toolBox.parseCustomSplit( valId, "-" ); }; if(valId!=""){ if( choiceClass == "checked"){ document.getElementById( valId ).checked=true; }; if( choiceClass == "selected"){ document.getElementById( valId ).selected=true; };}; if( setObj == "newSurveyInfo" ){ newSurveyInfo[openClass] = ObjTemp[openClass] ; }; if( setObj == "newSurvey" ){ newSurvey[openClass] = ObjTemp[openClass] ; }; if( setObj == "editSurveyInfo" ){ editSurveyInfo[openClass] = ObjTemp[openClass] ; }; if( setObj == "editSurvey" ){ newSurvey[openClass] = ObjTemp[openClass+"_"+ tempNum ] ; }; }; }); }; this.selectChoiceId = function( openClass, choiceClass, ObjTemp ){ $( '#'+openClass ).on( 'click', function(){ var valId=''; var valType = ""; var idClass = ""; var tempId = ""; var tempClass = ""; var tempClass = ""; var classId = ""; var tempCheck1 = ""; var tempCheck2 = ""; var objId ; var valAnswer = $(this).val(); if(valAnswer!= ""){ idClass = "option_"+openClass ; $.each($("."+idClass), function(){ var tempVal = $(this).val(); if(valAnswer==tempVal){ valId = $(this).attr('id'); tempClass = $(this).attr('class'); $("#"+valId).attr( choiceClass, true); } else{ $(this).attr( choiceClass, false); }; }); tempCheck1 = toolBox.validateObject( "option_test_id", tempClass ); tempCheck2 = toolBox.validateObject( "option_survey_name", tempClass ); if(tempCheck1==true || tempCheck2==true){ objId = toolBox.parseCustomSplit( valAnswer, ":" ); if(tempCheck1==true && tempCheck2==false){ var idName = "test_id"; }; if(tempCheck2==false && tempCheck2==true){ var idName = "survey_name"; }; valAnswer=$.trim(objId[1]); valType=$.trim(objId[0]); objId[1]=undefined; } else{ var idName = $(this).attr('name'); objId = toolBox.parseCustomSplit( valId, "-" ); }; var temp = ""; if( choiceClass == "checked"){ document.getElementById( valId ).checked=true; }; if( choiceClass == "selected"){ document.getElementById( valId ).selected=true; }; if(objId[1]){ temp = $.trim(objId[1]); }else{ temp = idName; }; if(valId!=""){ var orderCheck = toolBox.validateObject( "_order_", valId ); if( (typeof newSurveyInfo!="undefined" && ObjTemp == newSurveyInfo) && ( newSurveyInfo[temp] != undefined || ObjTemp[temp] != "" )){ newSurveyInfo[temp] = valAnswer; } else if( (typeof newSurvey!="undefined" && ObjTemp == newSurvey) && ( newSurvey[temp] != undefined || ObjTemp[temp] != "" )){ if(temp=="test_id"){ newSurvey[temp] = valType; } else{ newSurvey[temp] = valAnswer;}; } else if( (typeof editSurveyInfo!="undefined" && ObjTemp == editSurveyInfo) && ( editSurveyInfo[temp] != undefined || ObjTemp[temp] != "" ) ){ editSurveyInfo["form_type"] = valAnswer; editSurveyInfo.survey_name=valType ; } else if( (typeof editSurvey!="undefined" && ObjTemp == editSurvey) && ( editSurvey[temp] != undefined || ObjTemp[temp] != "" ) && orderCheck==false ){ editSurvey["form_type"] = valAnswer; } else if(orderCheck==true){ if(idClass=="option_order_A"){ var tempMarker1="set"; var tempMarker2="pre"; }; if(idClass=="option_order_B"){ var tempMarker1="pre"; var tempMarker2="set"; }; var tempStyle = render.markInput(valAnswer, tempMarker1, tempMarker2); } else{ /*none*/ }; }; }; }); }; this.setButtonId = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); if( editSurveyInfo.survey_name=="survey_name" || editSurveyInfo.survey_name=="" ){ $(".warn_message").empty().append("You must select a survey or test to edit."); } else{ admin.createEdit(valId, ""); }; }); }; this.answerOptionId = function( openClass ){ $("#"+openClass).on( 'click', function(){ var valAnswer ; var valId ; var tempVal ; var idClass ; newSurvey.answer=undefined; var valAnswer = $(this).val(); idClass = "option_"+openClass ; if(valAnswer!= ""){ $.each($("."+idClass), function(){ tempVal = $(this).val(); if(valAnswer==tempVal){ valId = $(this).attr('id'); tempClass = $(this).attr('class'); }; }); }; var objVal = toolBox.parseCustomSplit( valAnswer, ":" ); var objId = toolBox.parseCustomSplit( valId, "_" ); objVal[0] = $.trim(objVal[0]); objVal[1] = $.trim(objVal[1]); objId[0] = $.trim(objId[0]); if( objId[0] == "radio" || objId[0] == "checkbox"){ $(".new_answer").attr("type",objId[0]); $(".new_answer").attr( "checked", false); }; if( objVal[1] == "quiz"){ if(openClass=="option_survey_name"){ editSurvey.test_id=editSurveyInfo.survey_name= objVal[0] ; } else if(openClass=="option_test_id"){ newSurvey.test_id= objVal[0] ; } else{ $(".new_answer").attr("style","visibility:visible"); $(".new_answer").attr( "checked", false); localConfig.answer = "yes_answer"; }; }; if( objVal[1] == "survey"){ if(openClass=="option_survey_name"){ editSurvey.test_id=editSurveyInfo.survey_name= objVal[0] ; } else if(openClass=="option_test_id"){ newSurvey.test_id= objVal[0] ; } else{ $(".new_answer").attr("style","visibility:hidden"); $(".new_answer").attr( "checked", false); localConfig.answer= "no_answer"; }; }; }); }; this.setSurveyDefaults = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ render.page("defaults", ""); }); }; this.newButton = function( openClass ){ $( '#'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); admin.createNew(valId); }); }; this.setButton = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); if( editSurveyInfo.survey_name=="survey_name" || editSurveyInfo.survey_name=="" ){ $(".warn_message").empty().append("You must select a survey or test to edit."); } else{ admin.createEdit(valId, ""); }; }); }; this.orderButton = function( openClass ){ $( '#'+openClass ).on( 'click', function(){ var i1=0; var tempArray = []; $("#order_A" ).removeClass("input_checker_required"); $("#order_B").removeClass("input_checker_required"); var valIdA ; var valA=0 ; var valIdB ; var valB=0 ; var tempText=""; var temp = ""; $.each($(".option_order_A"), function(){ if( $(this).is(":selected")){ valIdA = $(this).attr('id'); valA = parseInt( $(this).val() ); }; }); $.each($(".option_order_B"), function(){ if( $(this).is(":selected")){ valIdB = $(this).attr('id'); valB = parseInt( $(this).val() ); }; }); if(valA==valB){ tempText="Question Number and Move Behind Number the same."; $("#order_A" ).addClass("input_checker_required"); $("#order_B" ).addClass("input_checker_required"); }; if(valA==(valB - 1) ){ tempText="To make this change, make Question# "+valB+" and 'Move Behind' # "+valA+"."; $("#order_A" ).addClass("input_checker_required"); $("#order_B" ).addClass("input_checker_required"); } else if(valA>=1 && valB>=1){ $.each(editSurvey, function(key1,val1){ var val1=parseInt(val1); var orderCheck = toolBox.validateObject( "question_order_", key1 ); if(orderCheck==true){ i1++; var tempNum = parseInt( key1.replace( "question_order_", "" ) ); if(valA<valB){ if(val1==valA){ editSurvey[key1] = valB-1; temp += key1 +"|:|"+editSurvey[key1]+"|_-_| "; }; if(val1>valA && val1<valB ){ editSurvey[key1] = val1-1; temp += key1 +"|:|"+editSurvey[key1]+"|_-_| "; }; } else if(valA>valB){ if(val1==valA){ editSurvey[key1] = valB; temp += key1 +"|:|"+editSurvey[key1]+"|_-_| "; }; if(val1<valA && val1>=valB ){ editSurvey[key1] = val1+1; temp += key1 +"|:|"+editSurvey[key1]+"|_-_| "; }; } else{ /*do nothing*/ }; if( editSurvey["question_"+tempNum].length>103){ var tempTitle = editSurvey["question_"+tempNum].substring(0, 100) +"..."; } else{ var tempTitle = editSurvey["question_"+tempNum]; }; tempTitle = tempTitle.replace(/\\/g,""); var tempHTML = htmlBox.buildButton( "Edit Question #"+ editSurvey["question_order_"+tempNum] + ": "+ tempTitle , "question_order_"+editSurvey["question_order_"+tempNum], "question_append "+key1 ); tempArray[ editSurvey[key1] ] = htmlBox.buildIdElement( tempHTML, "p", "survey_edit_info-"+editSurvey["question_order_"+tempNum], " " ); }; }); loader.adminOrderEdit( temp ); $("div#survey_edit_info").empty(); var i2=0; while(i2<i1){ i2++; $("div#survey_edit_info").append(tempArray[i2] ); }; $(".option_order_A").attr( "selected", false); $(".option_order_B").attr( "selected", false); handlers.editAppend("info_append"); handlers.editAppend("question_append"); } else{ if(valA==0){ tempText+="Question Number not selected. "; $("#order_A" ).addClass("input_checker_required"); }; if(valB==0){ tempText+="'Change to' Number not selected."; $("#order_B" ).addClass("input_checker_required"); };}; $(".warn_message").empty().append(tempText); }); }; this.editAppend = function(openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); var valClass = $(this).attr('class'); valClass = valClass.replace(openClass, ""); if(openClass == "info_append"){ valId = valId.replace("info_edit_",""); admin.createEdit(openClass, valId); }; if(openClass == "question_append"){ var tempClass = toolBox.parseCustomSplit( valClass, " " ); $.each(tempClass, function(key, val){ var idCheck1 = toolBox.validateObject( "question_", val ); var idCheck2 = toolBox.validateObject( "question_order_", val ); if(idCheck1==true){ if(idCheck2==false){ var questionId = val.replace("question_",""); questionId =parseInt(questionId); }; if(idCheck1==true && idCheck2==true){ var questionId = val.replace("question_order_",""); questionId =parseInt(questionId); }; admin.createEdit(openClass, questionId); }; }); }; }); }; this.selectChoice = function( openClass, choiceClass, ObjTemp ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); var idType = $(this).attr('type'); var idClass = $(this).attr('class'); var valAnswer = $(this).val(); if(idClass=="option_test_id" || idClass=="option_survey_name"){ var idName = idClass.replace("option_",""); var objId = toolBox.parseCustomSplit( valAnswer, ":" ); valAnswer=$.trim(objId[1]); objId[1]=undefined;} else{ var idName = $(this).attr('name'); var objId = toolBox.parseCustomSplit( valId, "-" ); }; var setObj = ""; var temp = ""; var temp2 = ""; if(idType!="checkbox"){ $("."+openClass).attr( choiceClass, false); $("#"+valId).attr( choiceClass, true); if( choiceClass == "checked"){ document.getElementById( valId ).checked=true; }; if( choiceClass == "selected"){ document.getElementById( valId ).selected=true; }; if(objId[1]){ temp = $.trim(objId[1]); }else{ temp = idName; }; if(valId!=""){ var orderCheck = toolBox.validateObject( "-order_", valId ); if( (typeof newSurveyInfo!="undefined" && ObjTemp == newSurveyInfo) && ( newSurveyInfo[temp] != undefined || ObjTemp[temp] != "" )){ newSurveyInfo[temp] = valAnswer; } else if( (typeof newSurvey!="undefined" && ObjTemp == newSurvey) && ( newSurvey[temp] != undefined || ObjTemp[temp] != "" )){ newSurvey[temp] = valAnswer; } else if( (typeof editSurveyInfo!="undefined" && ObjTemp == editSurveyInfo) && ( editSurveyInfo[temp] != undefined || ObjTemp[temp] != "" ) ){ editSurveyInfo["form_type"] = valAnswer; } else if( (typeof editSurvey!="undefined" && ObjTemp == editSurvey) && ( editSurvey[temp] != undefined || ObjTemp[temp] != "" ) && orderCheck==false ){ editSurvey["form_type"] = valAnswer; } else if(orderCheck==true){ if(idClass=="option_order_A"){ var tempMarker1="set"; var tempMarker2="pre"; }; if(idClass=="option_order_B"){ var tempMarker1="pre"; var tempMarker2="set"; }; var tempStyle = render.markInput(valAnswer, tempMarker1, tempMarker2); } else{ /*none*/ }; }; }; }); }; this.multipleChoice = function( openClass){ $( '.'+openClass ).on( 'click', function(){ var idAnswer = $(this).attr('id'); var idType = $(this).attr('type'); var valAnswer = ""; if(idType=="checkbox"){ if( $("#"+idAnswer).is(":checked") ){ $("#"+idAnswer).attr('checked', true); document.getElementById( idAnswer ).checked=true; } else{ $("#"+idAnswer).attr('checked', false); document.getElementById( idAnswer ).checked=false; }; }; }); }; this.answerOption = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); var valAnswer = $(this).val(); var objVal = toolBox.parseCustomSplit( valAnswer, ":" ); var objId = toolBox.parseCustomSplit( valId, "-" ); objVal[0] = $.trim(objVal[0]); objVal[1] = $.trim(objVal[1]); objId[0] = $.trim(objId[0]); if( objId[0] == "radio" || objId[0] == "checkbox"){ $(".new_answer").attr("type",objId[0]); $(".new_answer").attr( "checked", false); }; if( objVal[1] == "quiz"){ if(openClass=="option_survey_name"){ editSurvey.test_id=editSurveyInfo.survey_name= objVal[0]; } else{ $(".new_answer").attr("style","visibility:visible"); $(".new_answer").attr( "checked", false); localConfig.answer = "yes_answer"; newSurvey.test_id= valId ; }; }; if( objVal[1] == "survey"){ if(openClass=="option_survey_name"){ editSurvey.test_id=editSurveyInfo.survey_name= objVal[0] ; } else{ $(".new_answer").attr("style","visibility:hidden"); $(".new_answer").attr( "checked", false); localConfig.answer= "no_answer"; newSurvey.test_id= valId ; }; }; }); }; this.addChoice = function( openClass ,tempArray ){ $( '#'+openClass ).on( 'click', function(){ if($(".warn_choice").length>0){ $(".warn_choice").remove();}; var i=1; var choiceCheck = ""; var valType = ""; var valStyle= ""; var objId =[]; $.each($(".new_answer") , function(){ var valId = $(this).attr('id'); valType = $(this).attr('type'); valStyle = $(this).attr('style'); objId = toolBox.parseCustomSplit( valId, "_" ); choiceCheck = toolBox.validateObject( "visibility:hidden", valStyle); }); while(i<=$.trim(objId[1]) ){ i++; }; var temp = view.buildChoices(i, tempArray); $("#choices_holder").append(temp); if( choiceCheck == true){ $("#answer_"+i).attr("style", valStyle).attr("type", valType); }; if( choiceCheck== false){ $("#answer_"+i).attr("style", valStyle).attr("type", valType);}; var tempVal = "choices_"+i ; handlers.changeCounter( tempVal, 250, newSurvey ); handlers.cleanInputText( tempVal, "lit_string", newSurvey ); handlers.deleteChoice("delete_choice"); handlers.selectChoice( "new_answer", "checked", newSurvey ); handlers.multipleChoice( "new_answer", "checked", newSurvey ); }); }; this.deleteChoice = function( openClass){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); var valTemp = ""; var objId = toolBox.parseCustomSplit( valId, "_" ); var html = htmlBox.buildElement( "You must have at least 2 choices", "blockquote", "class='warn_choice red-alert small_box'"); var i1=0; var i2=0; var i3=0; if(openClass== "delete_choice"){ $.each($(".delete_choice"), function(){ i1++ ; }); if(i1>=3){ objId[1]=$.trim(objId[1]); $("#answer_"+objId[1]).remove(); $("#choices_"+objId[1]+"_counter").remove(); $("#choices_"+objId[1]).remove(); $("#"+valId).remove(); newSurvey["choices_"+objId[1]]=undefined ; if($(".warn_choice").length>0){ $(".warn_choice").remove();}; } else{ if($(".warn_choice").length<1){ $("p#choices_holder").append(html);}; }; }; if(openClass=="new_question"){ var tempRemove = []; $(".new_choice").removeAttr("style"); $.each($(".new_choice"), function(){ i1++ ; valId = $(this).attr('id'); var objId = toolBox.parseCustomSplit( valId, "_" ); $("#choices_"+objId[1]).trigger('click'); valTemp = $(this).val(); valTemp = $.trim(valTemp); if(valTemp.length <1){ if(i1<=2){i2++; tempRemove[i2]=objId[1]; $("#choices_"+objId[1] ).addClass("input_checker_required"); }; if(i1>2){ newSurvey["choices_"+i1]=undefined; $("#answer_"+objId[1]).remove(); $("#choices_"+objId[1]+"_counter").remove(); $("#delete_"+objId[1]).remove(); $("#choices_"+objId[1]).remove(); }; } else{ i3++; $("#choices_"+objId[1] ).removeClass("input_checker_required")}; }); if(i3>=2){ $.each(tempRemove, function(key, val){ $("#answer_"+val).remove(); $("#choices_"+val+"_counter").remove(); $("#delete_"+val).remove(); $("#choices_"+val).remove(); newSurvey["choices_"+i1]=undefined; }); } else if(i3==1 && i2>1){ if($(".warn_choice").length<1){ $("p#choices_holder").append(html); newSurvey.choices_1="choices_1"; }; $.each(tempRemove, function(key, val){ if(key!=1){$("#answer_"+val).remove(); $("#choices_"+val+"_counter").remove(); $("#delete_"+val).remove(); $("#choices_"+val).remove();}; }); } else{ if($(".warn_choice").length<1){ $("p#choices_holder").append(html);}; newSurvey.choices_1="choices_1"; }; }; }); }; this.setResultsId = function( openClass ,tempArray ){ $( '.'+openClass ).on( 'click', function(){ if(tempArray){ $.each(tempArray, function(key, val){ var tempCheck = toolBox.validateObject( "instruction", val ); if(tempCheck==false){ $("#"+ val).removeClass("input_checker_required"); var tempVal =newSurvey[val]; if(tempVal==val){ tempVal="NULL"; }; if(openClass=="new_question"){ handlers.checkChoiceId( val, "selected", newSurvey, tempVal, "" ); }; if(openClass=="new_info_page"){ handlers.checkChoiceId( val, "selected", newSurveyInfo, tempVal, "" ); }; $("#"+ val).trigger('checker'); }; }); }; var editOption =$("#edit_number").attr("name"); if(editOption==undefined){ editOption=""; }; var tempCheck = toolBox.validateObject( "info_", editOption ); if( tempCheck ==true ){ editOption = editOption.replace("info_",""); }; var tempCheck = toolBox.validateObject( "question_", editOption ); if( tempCheck ==true ){ editOption = editOption.replace("question_","");}; admin.checkSet( openClass, editOption ); }); }; this.setResults = function( openClass ,tempArray ){ $( '.'+openClass ).on( 'click', function(){ if(tempArray){ $.each(tempArray, function(key, val){ var tempCheck = toolBox.validateObject( "instruction", val ); if(tempCheck==false){$('#'+val).trigger('click'); }; }); }; var editOption =$("#edit_number").attr("name"); if(editOption==undefined){ editOption=""; }; var tempCheck = toolBox.validateObject( "info_", editOption ); if( tempCheck ==true ){ editOption = editOption.replace("info_",""); }; var tempCheck = toolBox.validateObject( "question_", editOption ); if( tempCheck ==true ){ editOption = editOption.replace("question_",""); }; admin.checkSet( openClass, editOption ); }); }; this.landing = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ $("#survey-content").empty(); render.landing(); }); }; this.publish = function( openClass ){ $( '#'+openClass ).on( 'click', function(){ admin.publisher(openClass,"",""); }); }; this.publisher = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); var tempArray = toolBox.parseCustomSplit(valId,":"); var tempName = $.trim(tempArray[0]); var tempNum = parseInt(tempArray[1]); admin.publisher(openClass, tempName, tempNum); }); }; this.downloader = function( openClass ){ $( '.'+openClass ).on( 'click', function(){ var valId = $(this).attr('id'); admin.downloader(openClass, valId); }); };}; 
 });